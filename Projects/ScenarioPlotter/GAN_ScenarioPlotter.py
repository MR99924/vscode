import sys
sys.path.append(r'C:\Users\MR99924\workspace\vscode\Projects\assetallocation-research\data_etl')
import os
import pandas as pd
import numpy as np
import math
from joblib import dump, load
import datetime as dt
from sklearn.ensemble import RandomForestClassifier
from sklearn.calibration import calibration_curve
from sklearn.preprocessing import LabelEncoder
from sklearn.model_selection import train_test_split, learning_curve
from sklearn.metrics import classification_report, accuracy_score,  precision_score, recall_score, f1_score, precision_recall_curve, average_precision_score
from sklearn.metrics import confusion_matrix, roc_curve, auc
import matplotlib.pyplot as plt
import seaborn as sns
from macrobond import Macrobond
import bloomberg
import traceback

mb = Macrobond()
label_encoder = LabelEncoder()

# We now move to the bloomberg function we have sorted out.

def get_bloomberg_date(tickers, date_from, date_to, field="PX_LAST", periodicity="DAILY"):
   bbg = bloomberg.Bloomberg()
   df = bbg.historicalRequest(tickers,
                              field,
                              date_from,
                              date_to,
                              periodicitySelection=periodicity,
                              nonTradingDayFillOption="ALL_CALENDAR_DAYS",
                              nonTradingDayFillMethod="PREVIOUS_VALUE",
                              )
   df = pd.pivot_table(df,
                       values='bbergvalue',
                       index=['bbergdate'],
                       columns=['bbergsymbol'],
                      aggfunc=np.max,
                      )
   df = df[tickers]
   return df

def apply_backfill_after_first_observation(df):
    for column in df.columns:
        first_valid_index = df[column].first_valid_index()
        if first_valid_index is not None:
            df.loc[first_valid_index:, column] = df.loc[first_valid_index:, column].bfill()
    return df


# Let's start by importing our data for each of the series we are interested in...

# We begin by looking at the policy rates we are trying to pull (Bloomberg)

gdp_tickers = ["imfweo_al_ngdp_r",
                "imfweo_dz_ngdp_r",
                "imfweo_ao_ngdp_r",
                "unctad_naac_gdp_153_2015_tot",
                "imfweo_am_ngdp_r",
                "imfweo_at_ngdp_r",
                "imfweo_az_ngdp_r",
                "unctad_naac_gdp_161_2015_tot",
                "imfweo_by_ngdp_r",
                "imfweo_be_ngdp_r",
                "imfweo_bj_ngdp_r",
                "unctad_naac_gdp_169_2015_tot",
                "imfweo_ba_ngdp_r",
                "imfweo_bw_ngdp_r",
                "unctad_naac_gdp_173_2015_tot",
                "imfweo_bg_ngdp_r",
                "imfweo_bf_ngdp_r",
                "imfweo_bi_ngdp_r",
                "unctad_naac_gdp_180_2015_tot",
                "imfweo_cm_ngdp_r",
                "imfweo_cv_ngdp_r",
                "unctad_naac_gdp_184_2015_tot",
                "imfweo_td_ngdp_r",
                "unctad_naac_gdp_186_2015_tot",
                "imfweo_cn_ngdp_r",
                "imfweo_co_ngdp_r",
                "imfweo_km_ngdp_r",
                "unctad_naac_gdp_202_2015_tot",
                "imfweo_cg_ngdp_r",
                "imfweo_cr_ngdp_r",
                "imfweo_ci_ngdp_r",
                "imfweo_hr_ngdp_r",
                "imfweo_cz_ngdp_r",
                "imfweo_dk_ngdp_r",
                "imfweo_dj_ngdp_r",
                "imfweo_dm_ngdp_r",
                "imfweo_do_ngdp_r",
                "imfweo_ec_ngdp_r",
                "unctad_naac_gdp_208_2015_tot",
                "imfweo_sv_ngdp_r",
                "unctad_naac_gdp_210_2015_tot",
                "imfweo_er_ngdp_r",
                "imfweo_ee_ngdp_r",
                "imfweo_et_ngdp_r",
                "imfweo_fj_ngdp_r",
                "imfweo_fi_ngdp_r",
                "imfweo_fr_ngdp_r",
                "imfweo_ga_ngdp_r",
                "imfweo_gm_ngdp_r",
                "imfweo_ge_ngdp_r",
                "imfweo_de_ngdp_r",
                "unctad_naac_gdp_224_2015_tot",
                "imfweo_gr_ngdp_r",
                "imfweo_gd_ngdp_r",
                "imfweo_gt_ngdp_r",
                "imfweo_gn_ngdp_r",
                "unctad_naac_gdp_232_2015_tot",
                "imfweo_gy_ngdp_r",
                "imfweo_ht_ngdp_r",
                "imfweo_hn_ngdp_r",
                "imfweo_hu_ngdp_r",
                "unctad_naac_gdp_238_2015_tot",
                "imfweo_in_ngdp_r",
                "unctad_naac_gdp_240_2015_tot",
                "imfweo_ir_ngdp_r",
                "imfweo_ie_ngdp_r",
                "il_ny_gdp_mktp_kd",
                "imfweo_it_ngdp_r",
                "jm_ny_gdp_mktp_kd",
                "imfweo_jp_ngdp_r",
                "imfweo_jo_ngdp_r",
                "imfweo_kz_ngdp_r",
                "imfweo_ke_ngdp_r",
                "imfweo_kr_ngdp_r",
                "imfweo_kw_ngdp_r",
                "imfweo_kg_ngdp_r",
                "unctad_naac_gdp_256_2015_tot",
                "imfweo_lv_ngdp_r",
                "imfweo_lb_ngdp_r",
                "imfweo_ls_ngdp_r",
                "unctad_naac_gdp_260_2015_tot",
                "imfweo_ly_ngdp_r",
                "imfweo_lt_ngdp_r",
                "imfweo_lu_ngdp_r",
                "imfweo_mk_ngdp_r",
                "imfweo_mg_ngdp_r",
                "imfweo_mw_ngdp_r",
                "imfweo_my_ngdp_r",
                "unctad_naac_gdp_267_2015_tot",
                "imfweo_ml_ngdp_r",
                "imfweo_mr_ngdp_r",
                "unctad_naac_gdp_273_2015_tot",
                "imfweo_md_ngdp_r",
                "imfweo_mn_ngdp_r",
                "unctad_naac_gdp_278_2015_tot",
                "imfweo_mz_ngdp_r",
                "unctad_naac_gdp_280_2015_tot",
                "imfweo_na_ngdp_r",
                "imfweo_np_ngdp_r",
                "imfweo_nl_ngdp_r",
                "imfweo_nz_ngdp_r",
                "unctad_naac_gdp_288_2015_tot",
                "imfweo_ne_ngdp_r",
                "imfweo_ng_ngdp_r",
                "imfweo_no_ngdp_r",
                "unctad_naac_gdp_296_2015_tot",
                "imfweo_pa_ngdp_r",
                "imfweo_pg_ngdp_r",
                "imfweo_py_ngdp_r",
                "unctad_naac_gdp_303_2015_tot",
                "imfweo_ph_ngdp_r",
                "imfweo_pl_ngdp_r",
                "imfweo_pt_ngdp_r",
                "imfweo_ro_ngdp_r",
                "imfweo_ru_ngdp_r",
                "imfweo_rw_ngdp_r",
                "imfweo_st_ngdp_r",
                "imfweo_sn_ngdp_r",
                "imfweo_rs_ngdp_r",
                "imfweo_sc_ngdp_r",
                "unctad_naac_gdp_325_2015_tot",
                "imfweo_sk_ngdp_r",
                "imfweo_si_ngdp_r",
                "imfweo_za_ngdp_r",
                "unctad_naac_gdp_334_2015_tot",
                "unctad_naac_gdp_335_2015_tot",
                "unctad_naac_gdp_337_2015_tot",
                "imfweo_sr_ngdp_r",
                "imfweo_se_ngdp_r",
                "imfweo_sy_ngdp_r",
                "imfweo_ch_ngdp_r",
                "imfweo_tj_ngdp_r",
                "imfweo_tz_ngdp_r",
                "imfweo_th_ngdp_r",
                "unctad_naac_gdp_348_2015_tot",
                "imfweo_tt_ngdp_r",
                "imfweo_tn_ngdp_r",
                "unctad_naac_gdp_353_2015_tot",
                "imfweo_tm_ngdp_r",
                "unctad_naac_gdp_357_2015_tot",
                "imfweo_ua_ngdp_r",
                "imfweo_gb_ngdp_r",
                "imfweo_us_ngdp_r",
                "unctad_naac_gdp_363_2015_tot",
                "imfweo_uz_ngdp_r",
                "imfweo_ve_ngdp_r",
                "unctad_naac_gdp_367_2015_tot",
                "imfweo_ye_ngdp_r",
                "imfweo_zm_ngdp_r",
                "imfweo_zw_ngdp_r"]

gdp_data = mb.FetchSeries(gdp_tickers)

new_column_names = {"imfweo_al_ngdp_r" : "gdp_al",
                    "imfweo_dz_ngdp_r" : "gdp_dz",
                    "imfweo_ao_ngdp_r" : "gdp_ao",
                    "unctad_naac_gdp_153_2015_tot" : "gdp_ar",
                    "imfweo_am_ngdp_r" : "gdp_am",
                    "imfweo_at_ngdp_r" : "gdp_at",
                    "imfweo_az_ngdp_r" : "gdp_az",
                    "unctad_naac_gdp_161_2015_tot" : "gdp_bd",
                    "imfweo_by_ngdp_r" : "gdp_by",
                    "imfweo_be_ngdp_r" : "gdp_be",
                    "imfweo_bj_ngdp_r" : "gdp_bj",
                    "unctad_naac_gdp_169_2015_tot" : "gdp_bo",
                    "imfweo_ba_ngdp_r" : "gdp_ba",
                    "imfweo_bw_ngdp_r" : "gdp_bw",
                    "unctad_naac_gdp_173_2015_tot" : "gdp_br",
                    "imfweo_bg_ngdp_r" : "gdp_bg",
                    "imfweo_bf_ngdp_r" : "gdp_bf",
                    "imfweo_bi_ngdp_r" : "gdp_bi",
                    "unctad_naac_gdp_180_2015_tot" : "gdp_kh",
                    "imfweo_cm_ngdp_r" : "gdp_cm",
                    "imfweo_cv_ngdp_r" : "gdp_cv",
                    "unctad_naac_gdp_184_2015_tot" : "gdp_cf",
                    "imfweo_td_ngdp_r" : "gdp_td",
                    "unctad_naac_gdp_186_2015_tot" : "gdp_cl",
                    "imfweo_cn_ngdp_r" : "gdp_cn",
                    "imfweo_co_ngdp_r" : "gdp_co",
                    "imfweo_km_ngdp_r" : "gdp_km",
                    "unctad_naac_gdp_202_2015_tot" : "gdp_cd",
                    "imfweo_cg_ngdp_r" : "gdp_cg",
                    "imfweo_cr_ngdp_r" : "gdp_cr",
                    "imfweo_ci_ngdp_r" : "gdp_ci",
                    "imfweo_hr_ngdp_r" : "gdp_hr",
                    "imfweo_cz_ngdp_r" : "gdp_cz",
                    "imfweo_dk_ngdp_r" : "gdp_dk",
                    "imfweo_dj_ngdp_r" : "gdp_dj",
                    "imfweo_dm_ngdp_r" : "gdp_dm",
                    "imfweo_do_ngdp_r" : "gdp_do",
                    "imfweo_ec_ngdp_r" : "gdp_ec",
                    "unctad_naac_gdp_208_2015_tot" : "gdp_eg",
                    "imfweo_sv_ngdp_r" : "gdp_sv",
                    "unctad_naac_gdp_210_2015_tot" : "gdp_gq",
                    "imfweo_er_ngdp_r" : "gdp_er",
                    "imfweo_ee_ngdp_r" : "gdp_ee",
                    "imfweo_et_ngdp_r" : "gdp_et",
                    "imfweo_fj_ngdp_r" : "gdp_fj",
                    "imfweo_fi_ngdp_r" : "gdp_fi",
                    "imfweo_fr_ngdp_r" : "gdp_fr",
                    "imfweo_ga_ngdp_r" : "gdp_ga",
                    "imfweo_gm_ngdp_r" : "gdp_gm",
                    "imfweo_ge_ngdp_r" : "gdp_ge",
                    "imfweo_de_ngdp_r" : "gdp_de",
                    "unctad_naac_gdp_224_2015_tot" : "gdp_gh",
                    "imfweo_gr_ngdp_r" : "gdp_gr",
                    "imfweo_gd_ngdp_r" : "gdp_gd",
                    "imfweo_gt_ngdp_r" : "gdp_gt",
                    "imfweo_gn_ngdp_r" : "gdp_gn",
                    "unctad_naac_gdp_232_2015_tot" : "gdp_gw",
                    "imfweo_gy_ngdp_r" : "gdp_gy",
                    "imfweo_ht_ngdp_r" : "gdp_ht",
                    "imfweo_hn_ngdp_r" : "gdp_hn",
                    "imfweo_hu_ngdp_r" : "gdp_hu",
                    "unctad_naac_gdp_238_2015_tot" : "gdp_is",
                    "imfweo_in_ngdp_r" : "gdp_in",
                    "unctad_naac_gdp_240_2015_tot" : "gdp_id",
                    "imfweo_ir_ngdp_r" : "gdp_ir",
                    "imfweo_ie_ngdp_r" : "gdp_ie",
                    "il_ny_gdp_mktp_kd" : "gdp_il",
                    "imfweo_it_ngdp_r" : "gdp_it",
                    "jm_ny_gdp_mktp_kd" : "gdp_jm",
                    "imfweo_jp_ngdp_r" : "gdp_jp",
                    "imfweo_jo_ngdp_r" : "gdp_jo",
                    "imfweo_kz_ngdp_r" : "gdp_kz",
                    "imfweo_ke_ngdp_r" : "gdp_ke",
                    "imfweo_kr_ngdp_r" : "gdp_kr",
                    "imfweo_kw_ngdp_r" : "gdp_kw",
                    "imfweo_kg_ngdp_r" : "gdp_kg",
                    "unctad_naac_gdp_256_2015_tot" : "gdp_la",
                    "imfweo_lv_ngdp_r" : "gdp_lv",
                    "imfweo_lb_ngdp_r" : "gdp_lb",
                    "imfweo_ls_ngdp_r" : "gdp_ls",
                    "unctad_naac_gdp_260_2015_tot" : "gdp_lr",
                    "imfweo_ly_ngdp_r" : "gdp_ly",
                    "imfweo_lt_ngdp_r" : "gdp_lt",
                    "imfweo_lu_ngdp_r" : "gdp_lu",
                    "imfweo_mk_ngdp_r" : "gdp_mk",
                    "imfweo_mg_ngdp_r" : "gdp_mg",
                    "imfweo_mw_ngdp_r" : "gdp_mw",
                    "imfweo_my_ngdp_r" : "gdp_my",
                    "unctad_naac_gdp_267_2015_tot" : "gdp_mv",
                    "imfweo_ml_ngdp_r" : "gdp_ml",
                    "imfweo_mr_ngdp_r" : "gdp_mr",
                    "unctad_naac_gdp_273_2015_tot" : "gdp_mx",
                    "imfweo_md_ngdp_r" : "gdp_md",
                    "imfweo_mn_ngdp_r" : "gdp_mn",
                    "unctad_naac_gdp_278_2015_tot" : "gdp_ma",
                    "imfweo_mz_ngdp_r" : "gdp_mz",
                    "unctad_naac_gdp_280_2015_tot" : "gdp_mm",
                    "imfweo_na_ngdp_r" : "gdp_na",
                    "imfweo_np_ngdp_r" : "gdp_np",
                    "imfweo_nl_ngdp_r" : "gdp_nl",
                    "imfweo_nz_ngdp_r" : "gdp_nz",
                    "unctad_naac_gdp_288_2015_tot" : "gdp_ni",
                    "imfweo_ne_ngdp_r" : "gdp_ne",
                    "imfweo_ng_ngdp_r" : "gdp_ng",
                    "imfweo_no_ngdp_r" : "gdp_no",
                    "unctad_naac_gdp_296_2015_tot" : "gdp_pk",
                    "imfweo_pa_ngdp_r" : "gdp_pa",
                    "imfweo_pg_ngdp_r" : "gdp_pg",
                    "imfweo_py_ngdp_r" : "gdp_py",
                    "unctad_naac_gdp_303_2015_tot" : "gdp_pe",
                    "imfweo_ph_ngdp_r" : "gdp_ph",
                    "imfweo_pl_ngdp_r" : "gdp_pl",
                    "imfweo_pt_ngdp_r" : "gdp_pt",
                    "imfweo_ro_ngdp_r" : "gdp_ro",
                    "imfweo_ru_ngdp_r" : "gdp_ru",
                    "imfweo_rw_ngdp_r" : "gdp_rw",
                    "imfweo_st_ngdp_r" : "gdp_st",
                    "imfweo_sn_ngdp_r" : "gdp_sn",
                    "imfweo_rs_ngdp_r" : "gdp_rs",
                    "imfweo_sc_ngdp_r" : "gdp_sc",
                    "unctad_naac_gdp_325_2015_tot" : "gdp_sl",
                    "imfweo_sk_ngdp_r" : "gdp_sk",
                    "imfweo_si_ngdp_r" : "gdp_si",
                    "imfweo_za_ngdp_r" : "gdp_za",
                    "unctad_naac_gdp_334_2015_tot" : "gdp_es",
                    "unctad_naac_gdp_335_2015_tot" : "gdp_lk",
                    "unctad_naac_gdp_337_2015_tot" : "gdp_sd",
                    "imfweo_sr_ngdp_r" : "gdp_sr",
                    "imfweo_se_ngdp_r" : "gdp_se",
                    "imfweo_sy_ngdp_r" : "gdp_sy",
                    "imfweo_ch_ngdp_r" : "gdp_ch",
                    "imfweo_tj_ngdp_r" : "gdp_tj",
                    "imfweo_tz_ngdp_r" : "gdp_tz",
                    "imfweo_th_ngdp_r" : "gdp_th",
                    "unctad_naac_gdp_348_2015_tot" : "gdp_tg",
                    "imfweo_tt_ngdp_r" : "gdp_tt",
                    "imfweo_tn_ngdp_r" : "gdp_tn",
                    "unctad_naac_gdp_353_2015_tot" : "gdp_tr",
                    "imfweo_tm_ngdp_r" : "gdp_tm",
                    "unctad_naac_gdp_357_2015_tot" : "gdp_ug",
                    "imfweo_ua_ngdp_r" : "gdp_ua",
                    "imfweo_gb_ngdp_r" : "gdp_gb",
                    "imfweo_us_ngdp_r" : "gdp_us",
                    "unctad_naac_gdp_363_2015_tot" : "gdp_uy",
                    "imfweo_uz_ngdp_r" : "gdp_uz",
                    "imfweo_ve_ngdp_r" : "gdp_ve",
                    "unctad_naac_gdp_367_2015_tot" : "gdp_vn",
                    "imfweo_ye_ngdp_r" : "gdp_ye",
                    "imfweo_zm_ngdp_r" : "gdp_zm",
                    "imfweo_zw_ngdp_r" : "gdp_zw"
                        }

gdp_data = gdp_data.rename(columns = new_column_names)
print(gdp_data.head())


# Now we move on to inflation (Macrobond)

fb_tickers = ["alfiscspfby",
            "dzfiscspfby",
            "aofiscspfby",
            "arfiscspfby",
            "amfiscspfby",
            "atfiscspfby",
            "azfiscspfby",
            "bdfiscspfby",
            "byfiscspfby",
            "befiscspfby",
            "bjfiscspfby",
            "bofiscspfby",
            "bafiscspfby",
            "bwfiscspfby",
            "brfiscspfby",
            "bgfiscspfby",
            "bffiscspfby",
            "bifiscspfby",
            "khfiscspfby",
            "cmfiscspfby",
            "cvfiscspfby",
            "cffiscspfby",
            "tdfiscspfby",
            "clfiscspfby",
            "cnfiscspfby",
            "cofiscspfby",
            "kmfiscspfby",
            "cdfiscspfby",
            "cgfiscspfby",
            "crfiscspfby",
            "cifiscspfby",
            "hrfiscspfby",
            "czfiscspfby",
            "dkfiscspfby",
            "djfiscspfby",
            "dmfiscspfby",
            "dofiscspfby",
            "ecfiscspfby",
            "egfiscspfby",
            "svfiscspfby",
            "gqfiscspfby",
            "erfiscspfby",
            "eefiscspfby",
            "etfiscspfby",
            "fjfiscspfby",
            "fifiscspfby",
            "frfiscspfby",
            "gafiscspfby",
            "gmfiscspfby",
            "gefiscspfby",
            "defiscspfby",
            "ghfiscspfby",
            "grfiscspfby",
            "gdfiscspfby",
            "gtfiscspfby",
            "gnfiscspfby",
            "gwfiscspfby",
            "gyfiscspfby",
            "htfiscspfby",
            "hnfiscspfby",
            "hufiscspfby",
            "isfiscspfby",
            "infiscspfby",
            "idfiscspfby",
            "irfiscspfby",
            "iefiscspfby",
            "ilfiscspfby",
            "itfiscspfby",
            "jmfiscspfby",
            "jpfiscspfby",
            "jofiscspfby",
            "kzfiscspfby",
            "kefiscspfby",
            "krfiscspfby",
            "kwfiscspfby",
            "kgfiscspfby",
            "lafiscspfby",
            "lvfiscspfby",
            "lbfiscspfby",
            "lsfiscspfby",
            "lrfiscspfby",
            "lyfiscspfby",
            "ltfiscspfby",
            "lufiscspfby",
            "mkfiscspfby",
            "mgfiscspfby",
            "mwfiscspfby",
            "myfiscspfby",
            "mvfiscspfby",
            "mlfiscspfby",
            "mrfiscspfby",
            "mxfiscspfby",
            "mdfiscspfby",
            "mnfiscspfby",
            "mafiscspfby",
            "mzfiscspfby",
            "mmfiscspfby",
            "nafiscspfby",
            "npfiscspfby",
            "nlfiscspfby",
            "nzfiscspfby",
            "nifiscspfby",
            "nefiscspfby",
            "ngfiscspfby",
            "nofiscspfby",
            "pkfiscspfby",
            "pafiscspfby",
            "pgfiscspfby",
            "pyfiscspfby",
            "pefiscspfby",
            "phfiscspfby",
            "plfiscspfby",
            "ptfiscspfby",
            "rofiscspfby",
            "rufiscspfby",
            "rwfiscspfby",
            "stfiscspfby",
            "snfiscspfby",
            "rsfiscspfby",
            "scfiscspfby",
            "slfiscspfby",
            "skfiscspfby",
            "sifiscspfby",
            "zafiscspfby",
            "esfiscspfby",
            "lkfiscspfby",
            "sdfiscspfby",
            "srfiscspfby",
            "sefiscspfby",
            "syfiscspfby",
            "chfiscspfby",
            "tjfiscspfby",
            "tzfiscspfby",
            "thfiscspfby",
            "tgfiscspfby",
            "ttfiscspfby",
            "tnfiscspfby",
            "trfiscspfby",
            "tmfiscspfby",
            "ugfiscspfby",
            "uafiscspfby",
            "gbfiscspfby",
            "usfiscspfby",
            "uyfiscspfby",
            "uzfiscspfby",
            "vefiscspfby",
            "vnfiscspfby",
            "yefiscspfby",
            "zmfiscspfby",
            "zwfiscspfby"]

fb_data = mb.FetchSeries(fb_tickers)

new_column_names = {
        "alfiscspfby" : "fb_al",
        "dzfiscspfby" : "fb_dz",
        "aofiscspfby" : "fb_ao",
        "arfiscspfby" : "fb_ar",
        "amfiscspfby" : "fb_am",
        "atfiscspfby" : "fb_at",
        "azfiscspfby" : "fb_az",
        "bdfiscspfby" : "fb_bd",
        "byfiscspfby" : "fb_by",
        "befiscspfby" : "fb_be",
        "bjfiscspfby" : "fb_bj",
        "bofiscspfby" : "fb_bo",
        "bafiscspfby" : "fb_ba",
        "bwfiscspfby" : "fb_bw",
        "brfiscspfby" : "fb_br",
        "bgfiscspfby" : "fb_bg",
        "bffiscspfby" : "fb_bf",
        "bifiscspfby" : "fb_bi",
        "khfiscspfby" : "fb_kh",
        "cmfiscspfby" : "fb_cm",
        "cvfiscspfby" : "fb_cv",
        "cffiscspfby" : "fb_cf",
        "tdfiscspfby" : "fb_td",
        "clfiscspfby" : "fb_cl",
        "cnfiscspfby" : "fb_cn",
        "cofiscspfby" : "fb_co",
        "kmfiscspfby" : "fb_km",
        "cdfiscspfby" : "fb_cd",
        "cgfiscspfby" : "fb_cg",
        "crfiscspfby" : "fb_cr",
        "cifiscspfby" : "fb_ci",
        "hrfiscspfby" : "fb_hr",
        "czfiscspfby" : "fb_cz",
        "dkfiscspfby" : "fb_dk",
        "djfiscspfby" : "fb_dj",
        "dmfiscspfby" : "fb_dm",
        "dofiscspfby" : "fb_do",
        "ecfiscspfby" : "fb_ec",
        "egfiscspfby" : "fb_eg",
        "svfiscspfby" : "fb_sv",
        "gqfiscspfby" : "fb_gq",
        "erfiscspfby" : "fb_er",
        "eefiscspfby" : "fb_ee",
        "etfiscspfby" : "fb_et",
        "fjfiscspfby" : "fb_fj",
        "fifiscspfby" : "fb_fi",
        "frfiscspfby" : "fb_fr",
        "gafiscspfby" : "fb_ga",
        "gmfiscspfby" : "fb_gm",
        "gefiscspfby" : "fb_ge",
        "defiscspfby" : "fb_de",
        "ghfiscspfby" : "fb_gh",
        "grfiscspfby" : "fb_gr",
        "gdfiscspfby" : "fb_gd",
        "gtfiscspfby" : "fb_gt",
        "gnfiscspfby" : "fb_gn",
        "gwfiscspfby" : "fb_gw",
        "gyfiscspfby" : "fb_gy",
        "htfiscspfby" : "fb_ht",
        "hnfiscspfby" : "fb_hn",
        "hufiscspfby" : "fb_hu",
        "isfiscspfby" : "fb_is",
        "infiscspfby" : "fb_in",
        "idfiscspfby" : "fb_id",
        "irfiscspfby" : "fb_ir",
        "iefiscspfby" : "fb_ie",
        "ilfiscspfby" : "fb_il",
        "itfiscspfby" : "fb_it",
        "jmfiscspfby" : "fb_jm",
        "jpfiscspfby" : "fb_jp",
        "jofiscspfby" : "fb_jo",
        "kzfiscspfby" : "fb_kz",
        "kefiscspfby" : "fb_ke",
        "krfiscspfby" : "fb_kr",
        "kwfiscspfby" : "fb_kw",
        "kgfiscspfby" : "fb_kg",
        "lafiscspfby" : "fb_la",
        "lvfiscspfby" : "fb_lv",
        "lbfiscspfby" : "fb_lb",
        "lsfiscspfby" : "fb_ls",
        "lrfiscspfby" : "fb_lr",
        "lyfiscspfby" : "fb_ly",
        "ltfiscspfby" : "fb_lt",
        "lufiscspfby" : "fb_lu",
        "mkfiscspfby" : "fb_mk",
        "mgfiscspfby" : "fb_mg",
        "mwfiscspfby" : "fb_mw",
        "myfiscspfby" : "fb_my",
        "mvfiscspfby" : "fb_mv",
        "mlfiscspfby" : "fb_ml",
        "mrfiscspfby" : "fb_mr",
        "mxfiscspfby" : "fb_mx",
        "mdfiscspfby" : "fb_md",
        "mnfiscspfby" : "fb_mn",
        "mafiscspfby" : "fb_ma",
        "mzfiscspfby" : "fb_mz",
        "mmfiscspfby" : "fb_mm",
        "nafiscspfby" : "fb_na",
        "npfiscspfby" : "fb_np",
        "nlfiscspfby" : "fb_nl",
        "nzfiscspfby" : "fb_nz",
        "nifiscspfby" : "fb_ni",
        "nefiscspfby" : "fb_ne",
        "ngfiscspfby" : "fb_ng",
        "nofiscspfby" : "fb_no",
        "pkfiscspfby" : "fb_pk",
        "pafiscspfby" : "fb_pa",
        "pgfiscspfby" : "fb_pg",
        "pyfiscspfby" : "fb_py",
        "pefiscspfby" : "fb_pe",
        "phfiscspfby" : "fb_ph",
        "plfiscspfby" : "fb_pl",
        "ptfiscspfby" : "fb_pt",
        "rofiscspfby" : "fb_ro",
        "rufiscspfby" : "fb_ru",
        "rwfiscspfby" : "fb_rw",
        "stfiscspfby" : "fb_st",
        "snfiscspfby" : "fb_sn",
        "rsfiscspfby" : "fb_rs",
        "scfiscspfby" : "fb_sc",
        "slfiscspfby" : "fb_sl",
        "skfiscspfby" : "fb_sk",
        "sifiscspfby" : "fb_si",
        "zafiscspfby" : "fb_za",
        "esfiscspfby" : "fb_es",
        "lkfiscspfby" : "fb_lk",
        "sdfiscspfby" : "fb_sd",
        "srfiscspfby" : "fb_sr",
        "sefiscspfby" : "fb_se",
        "syfiscspfby" : "fb_sy",
        "chfiscspfby" : "fb_ch",
        "tjfiscspfby" : "fb_tj",
        "tzfiscspfby" : "fb_tz",
        "thfiscspfby" : "fb_th",
        "tgfiscspfby" : "fb_tg",
        "ttfiscspfby" : "fb_tt",
        "tnfiscspfby" : "fb_tn",
        "trfiscspfby" : "fb_tr",
        "tmfiscspfby" : "fb_tm",
        "ugfiscspfby" : "fb_ug",
        "uafiscspfby" : "fb_ua",
        "gbfiscspfby" : "fb_gb",
        "usfiscspfby" : "fb_us",
        "uyfiscspfby" : "fb_uy",
        "uzfiscspfby" : "fb_uz",
        "vefiscspfby" : "fb_ve",
        "vnfiscspfby" : "fb_vn",
        "yefiscspfby" : "fb_ye",
        "zmfiscspfby" : "fb_zm",
        "zwfiscspfby" : "fb_zw"
            }

fb_data = fb_data.rename(columns = new_column_names)
print(fb_data.head())

# Now we move on to core inflation (Macrobond)

ca_tickers = ["imfweo_al_bca_ngdpd",
            "imfweo_dz_bca_ngdpd",
            "imfweo_ao_bca_ngdpd",
            "imfweo_ar_bca_ngdpd",
            "imfweo_am_bca_ngdpd",
            "imfweo_at_bca_ngdpd",
            "imfweo_az_bca_ngdpd",
            "imfweo_bd_bca_ngdpd",
            "imfweo_by_bca_ngdpd",
            "imfweo_be_bca_ngdpd",
            "imfweo_bj_bca_ngdpd",
            "imfweo_bo_bca_ngdpd",
            "imfweo_ba_bca_ngdpd",
            "imfweo_bw_bca_ngdpd",
            "imfweo_br_bca_ngdpd",
            "imfweo_bg_bca_ngdpd",
            "imfweo_bf_bca_ngdpd",
            "imfweo_bi_bca_ngdpd",
            "imfweo_kh_bca_ngdpd",
            "imfweo_cm_bca_ngdpd",
            "imfweo_cv_bca_ngdpd",
            "imfweo_cf_bca_ngdpd",
            "imfweo_td_bca_ngdpd",
            "imfweo_cl_bca_ngdpd",
            "imfweo_cn_bca_ngdpd",
            "imfweo_co_bca_ngdpd",
            "imfweo_km_bca_ngdpd",
            "imfweo_cd_bca_ngdpd",
            "imfweo_cg_bca_ngdpd",
            "imfweo_cr_bca_ngdpd",
            "imfweo_ci_bca_ngdpd",
            "imfweo_hr_bca_ngdpd",
            "imfweo_cz_bca_ngdpd",
            "imfweo_dk_bca_ngdpd",
            "imfweo_dj_bca_ngdpd",
            "imfweo_dm_bca_ngdpd",
            "imfweo_do_bca_ngdpd",
            "imfweo_ec_bca_ngdpd",
            "imfweo_eg_bca_ngdpd",
            "imfweo_sv_bca_ngdpd",
            "imfweo_gq_bca_ngdpd",
            "imfweo_er_bca_ngdpd",
            "imfweo_ee_bca_ngdpd",
            "imfweo_et_bca_ngdpd",
            "imfweo_fj_bca_ngdpd",
            "imfweo_fi_bca_ngdpd",
            "imfweo_fr_bca_ngdpd",
            "imfweo_ga_bca_ngdpd",
            "imfweo_gm_bca_ngdpd",
            "imfweo_ge_bca_ngdpd",
            "imfweo_de_bca_ngdpd",
            "imfweo_gh_bca_ngdpd",
            "imfweo_gr_bca_ngdpd",
            "imfweo_gd_bca_ngdpd",
            "imfweo_gt_bca_ngdpd",
            "imfweo_gn_bca_ngdpd",
            "imfweo_gw_bca_ngdpd",
            "imfweo_gy_bca_ngdpd",
            "imfweo_ht_bca_ngdpd",
            "imfweo_hn_bca_ngdpd",
            "imfweo_hu_bca_ngdpd",
            "imfweo_is_bca_ngdpd",
            "imfweo_in_bca_ngdpd",
            "imfweo_id_bca_ngdpd",
            "imfweo_ir_bca_ngdpd",
            "imfweo_ie_bca_ngdpd",
            "imfweo_il_bca_ngdpd",
            "imfweo_it_bca_ngdpd",
            "imfweo_jm_bca_ngdpd",
            "imfweo_jp_bca_ngdpd",
            "imfweo_jo_bca_ngdpd",
            "imfweo_kz_bca_ngdpd",
            "imfweo_ke_bca_ngdpd",
            "imfweo_kr_bca_ngdpd",
            "imfweo_kw_bca_ngdpd",
            "imfweo_kg_bca_ngdpd",
            "imfweo_la_bca_ngdpd",
            "imfweo_lv_bca_ngdpd",
            "imfweo_lb_bca_ngdpd",
            "imfweo_ls_bca_ngdpd",
            "imfweo_lr_bca_ngdpd",
            "imfweo_ly_bca_ngdpd",
            "imfweo_lt_bca_ngdpd",
            "imfweo_lu_bca_ngdpd",
            "imfweo_mk_bca_ngdpd",
            "imfweo_mg_bca_ngdpd",
            "imfweo_mw_bca_ngdpd",
            "imfweo_my_bca_ngdpd",
            "imfweo_mv_bca_ngdpd",
            "imfweo_ml_bca_ngdpd",
            "imfweo_mr_bca_ngdpd",
            "imfweo_mx_bca_ngdpd",
            "imfweo_md_bca_ngdpd",
            "imfweo_mn_bca_ngdpd",
            "imfweo_ma_bca_ngdpd",
            "imfweo_mz_bca_ngdpd",
            "imfweo_mm_bca_ngdpd",
            "imfweo_na_bca_ngdpd",
            "imfweo_np_bca_ngdpd",
            "imfweo_nl_bca_ngdpd",
            "imfweo_nz_bca_ngdpd",
            "imfweo_ni_bca_ngdpd",
            "imfweo_ne_bca_ngdpd",
            "imfweo_ng_bca_ngdpd",
            "imfweo_no_bca_ngdpd",
            "imfweo_pk_bca_ngdpd",
            "imfweo_pa_bca_ngdpd",
            "imfweo_pg_bca_ngdpd",
            "imfweo_py_bca_ngdpd",
            "imfweo_pe_bca_ngdpd",
            "imfweo_ph_bca_ngdpd",
            "imfweo_pl_bca_ngdpd",
            "imfweo_pt_bca_ngdpd",
            "imfweo_ro_bca_ngdpd",
            "imfweo_ru_bca_ngdpd",
            "imfweo_rw_bca_ngdpd",
            "imfweo_st_bca_ngdpd",
            "imfweo_sn_bca_ngdpd",
            "imfweo_rs_bca_ngdpd",
            "imfweo_sc_bca_ngdpd",
            "imfweo_sl_bca_ngdpd",
            "imfweo_sk_bca_ngdpd",
            "imfweo_si_bca_ngdpd",
            "imfweo_za_bca_ngdpd",
            "imfweo_es_bca_ngdpd",
            "imfweo_lk_bca_ngdpd",
            "imfweo_sd_bca_ngdpd",
            "imfweo_sr_bca_ngdpd",
            "imfweo_se_bca_ngdpd",
            "imfweo_sy_bca_ngdpd",
            "imfweo_ch_bca_ngdpd",
            "imfweo_tj_bca_ngdpd",
            "imfweo_tz_bca_ngdpd",
            "imfweo_th_bca_ngdpd",
            "imfweo_tg_bca_ngdpd",
            "imfweo_tt_bca_ngdpd",
            "imfweo_tn_bca_ngdpd",
            "imfweo_tr_bca_ngdpd",
            "imfweo_tm_bca_ngdpd",
            "imfweo_ug_bca_ngdpd",
            "imfweo_ua_bca_ngdpd",
            "imfweo_gb_bca_ngdpd",
            "imfweo_us_bca_ngdpd",
            "imfweo_uy_bca_ngdpd",
            "imfweo_uz_bca_ngdpd",
            "imfweo_ve_bca_ngdpd",
            "imfweo_vn_bca_ngdpd",
            "imfweo_ye_bca_ngdpd",
            "imfweo_zm_bca_ngdpd",
            "imfweo_zw_bca_ngdpd"]

ca_data = mb.FetchSeries(ca_tickers)

new_column_names = {"imfweo_al_bca_ngdpd" : "ca_al",
                    "imfweo_dz_bca_ngdpd" : "ca_dz",
                    "imfweo_ao_bca_ngdpd" : "ca_ao",
                    "imfweo_ar_bca_ngdpd" : "ca_ar",
                    "imfweo_am_bca_ngdpd" : "ca_am",
                    "imfweo_at_bca_ngdpd" : "ca_at",
                    "imfweo_az_bca_ngdpd" : "ca_az",
                    "imfweo_bd_bca_ngdpd" : "ca_bd",
                    "imfweo_by_bca_ngdpd" : "ca_by",
                    "imfweo_be_bca_ngdpd" : "ca_be",
                    "imfweo_bj_bca_ngdpd" : "ca_bj",
                    "imfweo_bo_bca_ngdpd" : "ca_bo",
                    "imfweo_ba_bca_ngdpd" : "ca_ba",
                    "imfweo_bw_bca_ngdpd" : "ca_bw",
                    "imfweo_br_bca_ngdpd" : "ca_br",
                    "imfweo_bg_bca_ngdpd" : "ca_bg",
                    "imfweo_bf_bca_ngdpd" : "ca_bf",
                    "imfweo_bi_bca_ngdpd" : "ca_bi",
                    "imfweo_kh_bca_ngdpd" : "ca_kh",
                    "imfweo_cm_bca_ngdpd" : "ca_cm",
                    "imfweo_cv_bca_ngdpd" : "ca_cv",
                    "imfweo_cf_bca_ngdpd" : "ca_cf",
                    "imfweo_td_bca_ngdpd" : "ca_td",
                    "imfweo_cl_bca_ngdpd" : "ca_cl",
                    "imfweo_cn_bca_ngdpd" : "ca_cn",
                    "imfweo_co_bca_ngdpd" : "ca_co",
                    "imfweo_km_bca_ngdpd" : "ca_km",
                    "imfweo_cd_bca_ngdpd" : "ca_cd",
                    "imfweo_cg_bca_ngdpd" : "ca_cg",
                    "imfweo_cr_bca_ngdpd" : "ca_cr",
                    "imfweo_ci_bca_ngdpd" : "ca_ci",
                    "imfweo_hr_bca_ngdpd" : "ca_hr",
                    "imfweo_cz_bca_ngdpd" : "ca_cz",
                    "imfweo_dk_bca_ngdpd" : "ca_dk",
                    "imfweo_dj_bca_ngdpd" : "ca_dj",
                    "imfweo_dm_bca_ngdpd" : "ca_dm",
                    "imfweo_do_bca_ngdpd" : "ca_do",
                    "imfweo_ec_bca_ngdpd" : "ca_ec",
                    "imfweo_eg_bca_ngdpd" : "ca_eg",
                    "imfweo_sv_bca_ngdpd" : "ca_sv",
                    "imfweo_gq_bca_ngdpd" : "ca_gq",
                    "imfweo_er_bca_ngdpd" : "ca_er",
                    "imfweo_ee_bca_ngdpd" : "ca_ee",
                    "imfweo_et_bca_ngdpd" : "ca_et",
                    "imfweo_fj_bca_ngdpd" : "ca_fj",
                    "imfweo_fi_bca_ngdpd" : "ca_fi",
                    "imfweo_fr_bca_ngdpd" : "ca_fr",
                    "imfweo_ga_bca_ngdpd" : "ca_ga",
                    "imfweo_gm_bca_ngdpd" : "ca_gm",
                    "imfweo_ge_bca_ngdpd" : "ca_ge",
                    "imfweo_de_bca_ngdpd" : "ca_de",
                    "imfweo_gh_bca_ngdpd" : "ca_gh",
                    "imfweo_gr_bca_ngdpd" : "ca_gr",
                    "imfweo_gd_bca_ngdpd" : "ca_gd",
                    "imfweo_gt_bca_ngdpd" : "ca_gt",
                    "imfweo_gn_bca_ngdpd" : "ca_gn",
                    "imfweo_gw_bca_ngdpd" : "ca_gw",
                    "imfweo_gy_bca_ngdpd" : "ca_gy",
                    "imfweo_ht_bca_ngdpd" : "ca_ht",
                    "imfweo_hn_bca_ngdpd" : "ca_hn",
                    "imfweo_hu_bca_ngdpd" : "ca_hu",
                    "imfweo_is_bca_ngdpd" : "ca_is",
                    "imfweo_in_bca_ngdpd" : "ca_in",
                    "imfweo_id_bca_ngdpd" : "ca_id",
                    "imfweo_ir_bca_ngdpd" : "ca_ir",
                    "imfweo_ie_bca_ngdpd" : "ca_ie",
                    "imfweo_il_bca_ngdpd" : "ca_il",
                    "imfweo_it_bca_ngdpd" : "ca_it",
                    "imfweo_jm_bca_ngdpd" : "ca_jm",
                    "imfweo_jp_bca_ngdpd" : "ca_jp",
                    "imfweo_jo_bca_ngdpd" : "ca_jo",
                    "imfweo_kz_bca_ngdpd" : "ca_kz",
                    "imfweo_ke_bca_ngdpd" : "ca_ke",
                    "imfweo_kr_bca_ngdpd" : "ca_kr",
                    "imfweo_kw_bca_ngdpd" : "ca_kw",
                    "imfweo_kg_bca_ngdpd" : "ca_kg",
                    "imfweo_la_bca_ngdpd" : "ca_la",
                    "imfweo_lv_bca_ngdpd" : "ca_lv",
                    "imfweo_lb_bca_ngdpd" : "ca_lb",
                    "imfweo_ls_bca_ngdpd" : "ca_ls",
                    "imfweo_lr_bca_ngdpd" : "ca_lr",
                    "imfweo_ly_bca_ngdpd" : "ca_ly",
                    "imfweo_lt_bca_ngdpd" : "ca_lt",
                    "imfweo_lu_bca_ngdpd" : "ca_lu",
                    "imfweo_mk_bca_ngdpd" : "ca_mk",
                    "imfweo_mg_bca_ngdpd" : "ca_mg",
                    "imfweo_mw_bca_ngdpd" : "ca_mw",
                    "imfweo_my_bca_ngdpd" : "ca_my",
                    "imfweo_mv_bca_ngdpd" : "ca_mv",
                    "imfweo_ml_bca_ngdpd" : "ca_ml",
                    "imfweo_mr_bca_ngdpd" : "ca_mr",
                    "imfweo_mx_bca_ngdpd" : "ca_mx",
                    "imfweo_md_bca_ngdpd" : "ca_md",
                    "imfweo_mn_bca_ngdpd" : "ca_mn",
                    "imfweo_ma_bca_ngdpd" : "ca_ma",
                    "imfweo_mz_bca_ngdpd" : "ca_mz",
                    "imfweo_mm_bca_ngdpd" : "ca_mm",
                    "imfweo_na_bca_ngdpd" : "ca_na",
                    "imfweo_np_bca_ngdpd" : "ca_np",
                    "imfweo_nl_bca_ngdpd" : "ca_nl",
                    "imfweo_nz_bca_ngdpd" : "ca_nz",
                    "imfweo_ni_bca_ngdpd" : "ca_ni",
                    "imfweo_ne_bca_ngdpd" : "ca_ne",
                    "imfweo_ng_bca_ngdpd" : "ca_ng",
                    "imfweo_no_bca_ngdpd" : "ca_no",
                    "imfweo_pk_bca_ngdpd" : "ca_pk",
                    "imfweo_pa_bca_ngdpd" : "ca_pa",
                    "imfweo_pg_bca_ngdpd" : "ca_pg",
                    "imfweo_py_bca_ngdpd" : "ca_py",
                    "imfweo_pe_bca_ngdpd" : "ca_pe",
                    "imfweo_ph_bca_ngdpd" : "ca_ph",
                    "imfweo_pl_bca_ngdpd" : "ca_pl",
                    "imfweo_pt_bca_ngdpd" : "ca_pt",
                    "imfweo_ro_bca_ngdpd" : "ca_ro",
                    "imfweo_ru_bca_ngdpd" : "ca_ru",
                    "imfweo_rw_bca_ngdpd" : "ca_rw",
                    "imfweo_st_bca_ngdpd" : "ca_st",
                    "imfweo_sn_bca_ngdpd" : "ca_sn",
                    "imfweo_rs_bca_ngdpd" : "ca_rs",
                    "imfweo_sc_bca_ngdpd" : "ca_sc",
                    "imfweo_sl_bca_ngdpd" : "ca_sl",
                    "imfweo_sk_bca_ngdpd" : "ca_sk",
                    "imfweo_si_bca_ngdpd" : "ca_si",
                    "imfweo_za_bca_ngdpd" : "ca_za",
                    "imfweo_es_bca_ngdpd" : "ca_es",
                    "imfweo_lk_bca_ngdpd" : "ca_lk",
                    "imfweo_sd_bca_ngdpd" : "ca_sd",
                    "imfweo_sr_bca_ngdpd" : "ca_sr",
                    "imfweo_se_bca_ngdpd" : "ca_se",
                    "imfweo_sy_bca_ngdpd" : "ca_sy",
                    "imfweo_ch_bca_ngdpd" : "ca_ch",
                    "imfweo_tj_bca_ngdpd" : "ca_tj",
                    "imfweo_tz_bca_ngdpd" : "ca_tz",
                    "imfweo_th_bca_ngdpd" : "ca_th",
                    "imfweo_tg_bca_ngdpd" : "ca_tg",
                    "imfweo_tt_bca_ngdpd" : "ca_tt",
                    "imfweo_tn_bca_ngdpd" : "ca_tn",
                    "imfweo_tr_bca_ngdpd" : "ca_tr",
                    "imfweo_tm_bca_ngdpd" : "ca_tm",
                    "imfweo_ug_bca_ngdpd" : "ca_ug",
                    "imfweo_ua_bca_ngdpd" : "ca_ua",
                    "imfweo_gb_bca_ngdpd" : "ca_gb",
                    "imfweo_us_bca_ngdpd" : "ca_us",
                    "imfweo_uy_bca_ngdpd" : "ca_uy",
                    "imfweo_uz_bca_ngdpd" : "ca_uz",
                    "imfweo_ve_bca_ngdpd" : "ca_ve",
                    "imfweo_vn_bca_ngdpd" : "ca_vn",
                    "imfweo_ye_bca_ngdpd" : "ca_ye",
                    "imfweo_zm_bca_ngdpd" : "ca_zm",
                    "imfweo_zw_bca_ngdpd" : "ca_zw"           }

ca_data = ca_data.rename(columns = new_column_names)
print(ca_data.head())


# Now we move on to currency values (Bloomberg)

curr_tickers = ["alb_xr",
                "dza_xr",
                "ago_xr",
                "arg_xr",
                "arm_xr",
                "aut_xr",
                "aze_xr",
                "bgd_xr",
                "blr_xr",
                "bel_xr",
                "ben_xr",
                "bol_xr",
                "bih_xr",
                "bwa_xr",
                "bra_xr",
                "bgr_xr",
                "bfa_xr",
                "bdi_xr",
                "khm_xr",
                "cmr_xr",
                "cpv_xr",
                "caf_xr",
                "tcd_xr",
                "chl_xr",
                "chn_xr",
                "col_xr",
                "com_xr",
                "cod_xr",
                "cog_xr",
                "cri_xr",
                "civ_xr",
                "hrv_xr",
                "cze_xr",
                "dnk_xr",
                "dji_xr",
                "dma_xr",
                "dom_xr",
                "ecu_xr",
                "egy_xr",
                "slv_xr",
                "gnq_xr",
                "imfm643ensa_xdc_xdr_rate",
                "est_xr",
                "eth_xr",
                "fji_xr",
                "fin_xr",
                "fra_xr",
                "gab_xr",
                "gmb_xr",
                "geo_xr",
                "deu_xr",
                "gha_xr",
                "grc_xr",
                "grd_xr",
                "gtm_xr",
                "gin_xr",
                "gnb_xr",
                "guy_xr",
                "hti_xr",
                "hnd_xr",
                "hun_xr",
                "isl_xr",
                "ind_xr",
                "idn_xr",
                "irn_xr",
                "irl_xr",
                "isr_xr",
                "ita_xr",
                "jam_xr",
                "jpn_xr",
                "jor_xr",
                "kaz_xr",
                "ken_xr",
                "kor_xr",
                "kwt_xr",
                "kgz_xr",
                "lao_xr",
                "lva_xr",
                "lbn_xr",
                "lso_xr",
                "lbr_xr",
                "bis_mlylyda",
                "ltu_xr",
                "lux_xr",
                "mkd_xr",
                "mdg_xr",
                "mwi_xr",
                "mys_xr",
                "mdv_xr",
                "mli_xr",
                "mrt_xr",
                "mex_xr",
                "mda_xr",
                "mng_xr",
                "mar_xr",
                "moz_xr",
                "mmr_xr",
                "nam_xr",
                "npl_xr",
                "nld_xr",
                "nzl_xr",
                "nic_xr",
                "ner_xr",
                "nga_xr",
                "nor_xr",
                "pak_xr",
                "pan_xr",
                "bis_mpgpgka",
                "pry_xr",
                "per_xr",
                "phl_xr",
                "pol_xr",
                "prt_xr",
                "rou_xr",
                "rus_xr",
                "rwa_xr",
                "stp_xr",
                "sen_xr",
                "srb_xr",
                "syc_xr",
                "sle_xr",
                "svk_xr",
                "svn_xr",
                "zaf_xr",
                "esp_xr",
                "lka_xr",
                "sdn_xr",
                "sur_xr",
                "swe_xr",
                "syr_xr",
                "che_xr",
                "tjk_xr",
                "tza_xr",
                "tha_xr",
                "tgo_xr",
                "tto_xr",
                "tun_xr",
                "tur_xr",
                "tkm_xr",
                "uga_xr",
                "ukr_xr",
                "gbr_xr",
                "usa_xr",
                "ury_xr",
                "uzb_xr",
                "ven_xr",
                "vnm_xr",
                "yem_xr",
                "zmb_xr",
                "zwe_xr"]

curr_data = mb.FetchSeries(curr_tickers)

new_column_names = {"alb_xr" : "xr_al",
                    "dza_xr" : "xr_dz",
                    "ago_xr" : "xr_ao",
                    "arg_xr" : "xr_ar",
                    "arm_xr" : "xr_am",
                    "aut_xr" : "xr_at",
                    "aze_xr" : "xr_az",
                    "bgd_xr" : "xr_bd",
                    "blr_xr" : "xr_by",
                    "bel_xr" : "xr_be",
                    "ben_xr" : "xr_bj",
                    "bol_xr" : "xr_bo",
                    "bih_xr" : "xr_ba",
                    "bwa_xr" : "xr_bw",
                    "bra_xr" : "xr_br",
                    "bgr_xr" : "xr_bg",
                    "bfa_xr" : "xr_bf",
                    "bdi_xr" : "xr_bi",
                    "khm_xr" : "xr_kh",
                    "cmr_xr" : "xr_cm",
                    "cpv_xr" : "xr_cv",
                    "caf_xr" : "xr_cf",
                    "tcd_xr" : "xr_td",
                    "chl_xr" : "xr_cl",
                    "chn_xr" : "xr_cn",
                    "col_xr" : "xr_co",
                    "com_xr" : "xr_km",
                    "cod_xr" : "xr_cd",
                    "cog_xr" : "xr_cg",
                    "cri_xr" : "xr_cr",
                    "civ_xr" : "xr_ci",
                    "hrv_xr" : "xr_hr",
                    "cze_xr" : "xr_cz",
                    "dnk_xr" : "xr_dk",
                    "dji_xr" : "xr_dj",
                    "dma_xr" : "xr_dm",
                    "dom_xr" : "xr_do",
                    "ecu_xr" : "xr_ec",
                    "egy_xr" : "xr_eg",
                    "slv_xr" : "xr_sv",
                    "gnq_xr" : "xr_gq",
                    "imfm643ensa_xdc_xdr_rate" : "xr_er",
                    "est_xr" : "xr_ee",
                    "eth_xr" : "xr_et",
                    "fji_xr" : "xr_fj",
                    "fin_xr" : "xr_fi",
                    "fra_xr" : "xr_fr",
                    "gab_xr" : "xr_ga",
                    "gmb_xr" : "xr_gm",
                    "geo_xr" : "xr_ge",
                    "deu_xr" : "xr_de",
                    "gha_xr" : "xr_gh",
                    "grc_xr" : "xr_gr",
                    "grd_xr" : "xr_gd",
                    "gtm_xr" : "xr_gt",
                    "gin_xr" : "xr_gn",
                    "gnb_xr" : "xr_gw",
                    "guy_xr" : "xr_gy",
                    "hti_xr" : "xr_ht",
                    "hnd_xr" : "xr_hn",
                    "hun_xr" : "xr_hu",
                    "isl_xr" : "xr_is",
                    "ind_xr" : "xr_in",
                    "idn_xr" : "xr_id",
                    "irn_xr" : "xr_ir",
                    "irl_xr" : "xr_ie",
                    "isr_xr" : "xr_il",
                    "ita_xr" : "xr_it",
                    "jam_xr" : "xr_jm",
                    "jpn_xr" : "xr_jp",
                    "jor_xr" : "xr_jo",
                    "kaz_xr" : "xr_kz",
                    "ken_xr" : "xr_ke",
                    "kor_xr" : "xr_kr",
                    "kwt_xr" : "xr_kw",
                    "kgz_xr" : "xr_kg",
                    "lao_xr" : "xr_la",
                    "lva_xr" : "xr_lv",
                    "lbn_xr" : "xr_lb",
                    "lso_xr" : "xr_ls",
                    "lbr_xr" : "xr_lr",
                    "bis_mlylyda" : "xr_ly",
                    "ltu_xr" : "xr_lt",
                    "lux_xr" : "xr_lu",
                    "mkd_xr" : "xr_mk",
                    "mdg_xr" : "xr_mg",
                    "mwi_xr" : "xr_mw",
                    "mys_xr" : "xr_my",
                    "mdv_xr" : "xr_mv",
                    "mli_xr" : "xr_ml",
                    "mrt_xr" : "xr_mr",
                    "mex_xr" : "xr_mx",
                    "mda_xr" : "xr_md",
                    "mng_xr" : "xr_mn",
                    "mar_xr" : "xr_ma",
                    "moz_xr" : "xr_mz",
                    "mmr_xr" : "xr_mm",
                    "nam_xr" : "xr_na",
                    "npl_xr" : "xr_np",
                    "nld_xr" : "xr_nl",
                    "nzl_xr" : "xr_nz",
                    "nic_xr" : "xr_ni",
                    "ner_xr" : "xr_ne",
                    "nga_xr" : "xr_ng",
                    "nor_xr" : "xr_no",
                    "pak_xr" : "xr_pk",
                    "pan_xr" : "xr_pa",
                    "bis_mpgpgka" : "xr_pg",
                    "pry_xr" : "xr_py",
                    "per_xr" : "xr_pe",
                    "phl_xr" : "xr_ph",
                    "pol_xr" : "xr_pl",
                    "prt_xr" : "xr_pt",
                    "rou_xr" : "xr_ro",
                    "rus_xr" : "xr_ru",
                    "rwa_xr" : "xr_rw",
                    "stp_xr" : "xr_st",
                    "sen_xr" : "xr_sn",
                    "srb_xr" : "xr_rs",
                    "syc_xr" : "xr_sc",
                    "sle_xr" : "xr_sl",
                    "svk_xr" : "xr_sk",
                    "svn_xr" : "xr_si",
                    "zaf_xr" : "xr_za",
                    "esp_xr" : "xr_es",
                    "lka_xr" : "xr_lk",
                    "sdn_xr" : "xr_sd",
                    "sur_xr" : "xr_sr",
                    "swe_xr" : "xr_se",
                    "syr_xr" : "xr_sy",
                    "che_xr" : "xr_ch",
                    "tjk_xr" : "xr_tj",
                    "tza_xr" : "xr_tz",
                    "tha_xr" : "xr_th",
                    "tgo_xr" : "xr_tg",
                    "tto_xr" : "xr_tt",
                    "tun_xr" : "xr_tn",
                    "tur_xr" : "xr_tr",
                    "tkm_xr" : "xr_tm",
                    "uga_xr" : "xr_ug",
                    "ukr_xr" : "xr_ua",
                    "gbr_xr" : "xr_gb",
                    "usa_xr" : "xr_us",
                    "ury_xr" : "xr_uy",
                    "uzb_xr" : "xr_uz",
                    "ven_xr" : "xr_ve",
                    "vnm_xr" : "xr_vn",
                    "yem_xr" : "xr_ye",
                    "zmb_xr" : "xr_zm",
                    "zwe_xr" : "xr_zw"}

curr_data = curr_data.rename(columns = new_column_names)
print(curr_data.head())


# Now we move on to currencies (Bloomberg)

rat_tickers = ["al_fr_inr_rinr",
                "dz_fr_inr_rinr",
                "ao_fr_inr_rinr",
                "ar_fr_inr_rinr",
                "am_fr_inr_rinr",
                "at_fr_inr_rinr",
                "az_fr_inr_rinr",
                "bd_fr_inr_rinr",
                "by_fr_inr_rinr",
                "be_fr_inr_rinr",
                "bj_fr_inr_rinr",
                "bo_fr_inr_rinr",
                "ba_fr_inr_rinr",
                "bw_fr_inr_rinr",
                "br_fr_inr_rinr",
                "bg_fr_inr_rinr",
                "bf_fr_inr_rinr",
                "bi_fr_inr_rinr",
                "kh_fr_inr_rinr",
                "cm_fr_inr_rinr",
                "cv_fr_inr_rinr",
                "cf_fr_inr_rinr",
                "td_fr_inr_rinr",
                "cl_fr_inr_rinr",
                "cn_fr_inr_rinr",
                "co_fr_inr_rinr",
                "km_fr_inr_rinr",
                "cd_fr_inr_rinr",
                "cg_fr_inr_rinr",
                "cr_fr_inr_rinr",
                "ci_fr_inr_rinr",
                "hr_fr_inr_rinr",
                "cz_fr_inr_rinr",
                "dk_fr_inr_rinr",
                "dj_fr_inr_rinr",
                "dm_fr_inr_rinr",
                "do_fr_inr_rinr",
                "ec_fr_inr_rinr",
                "eg_fr_inr_rinr",
                "sv_fr_inr_rinr",
                "gq_fr_inr_rinr",
                "er_fr_inr_rinr",
                "ee_fr_inr_rinr",
                "et_fr_inr_rinr",
                "fj_fr_inr_rinr",
                "fi_fr_inr_rinr",
                "fr_fr_inr_rinr",
                "ga_fr_inr_rinr",
                "gm_fr_inr_rinr",
                "ge_fr_inr_rinr",
                "de_fr_inr_rinr",
                "gh_fr_inr_rinr",
                "gr_fr_inr_rinr",
                "gd_fr_inr_rinr",
                "gt_fr_inr_rinr",
                "gn_fr_inr_rinr",
                "gw_fr_inr_rinr",
                "gy_fr_inr_rinr",
                "ht_fr_inr_rinr",
                "hn_fr_inr_rinr",
                "hu_fr_inr_rinr",
                "is_fr_inr_rinr",
                "in_fr_inr_rinr",
                "id_fr_inr_rinr",
                "ir_fr_inr_rinr",
                "ie_fr_inr_rinr",
                "il_fr_inr_rinr",
                "it_fr_inr_rinr",
                "jm_fr_inr_rinr",
                "jp_fr_inr_rinr",
                "jo_fr_inr_rinr",
                "kz_fr_inr_rinr",
                "ke_fr_inr_rinr",
                "kr_fr_inr_rinr",
                "kw_fr_inr_rinr",
                "kg_fr_inr_rinr",
                "la_fr_inr_rinr",
                "lv_fr_inr_rinr",
                "lb_fr_inr_rinr",
                "ls_fr_inr_rinr",
                "lr_fr_inr_rinr",
                "ly_fr_inr_rinr",
                "lt_fr_inr_rinr",
                "lu_fr_inr_rinr",
                "mk_fr_inr_rinr",
                "mg_fr_inr_rinr",
                "mw_fr_inr_rinr",
                "my_fr_inr_rinr",
                "mv_fr_inr_rinr",
                "ml_fr_inr_rinr",
                "mr_fr_inr_rinr",
                "mx_fr_inr_rinr",
                "md_fr_inr_rinr",
                "mn_fr_inr_rinr",
                "ma_fr_inr_rinr",
                "mz_fr_inr_rinr",
                "mm_fr_inr_rinr",
                "na_fr_inr_rinr",
                "np_fr_inr_rinr",
                "nl_fr_inr_rinr",
                "nz_fr_inr_rinr",
                "ni_fr_inr_rinr",
                "ne_fr_inr_rinr",
                "ng_fr_inr_rinr",
                "no_fr_inr_rinr",
                "pk_fr_inr_rinr",
                "pa_fr_inr_rinr",
                "pg_fr_inr_rinr",
                "py_fr_inr_rinr",
                "pe_fr_inr_rinr",
                "ph_fr_inr_rinr",
                "pl_fr_inr_rinr",
                "pt_fr_inr_rinr",
                "ro_fr_inr_rinr",
                "ru_fr_inr_rinr",
                "rw_fr_inr_rinr",
                "st_fr_inr_rinr",
                "sn_fr_inr_rinr",
                "rs_fr_inr_rinr",
                "sc_fr_inr_rinr",
                "sl_fr_inr_rinr",
                "sk_fr_inr_rinr",
                "si_fr_inr_rinr",
                "za_fr_inr_rinr",
                "es_fr_inr_rinr",
                "lk_fr_inr_rinr",
                "sd_fr_inr_rinr",
                "sr_fr_inr_rinr",
                "se_fr_inr_rinr",
                "sy_fr_inr_rinr",
                "ch_fr_inr_rinr",
                "tj_fr_inr_rinr",
                "tz_fr_inr_rinr",
                "th_fr_inr_rinr",
                "tg_fr_inr_rinr",
                "tt_fr_inr_rinr",
                "tn_fr_inr_rinr",
                "tr_fr_inr_rinr",
                "tm_fr_inr_rinr",
                "ug_fr_inr_rinr",
                "ua_fr_inr_rinr",
                "gb_fr_inr_rinr",
                "us_fr_inr_rinr",
                "uy_fr_inr_rinr",
                "uz_fr_inr_rinr",
                "ve_fr_inr_rinr",
                "vn_fr_inr_rinr",
                "ye_fr_inr_rinr",
                "zm_fr_inr_rinr",
                "zw_fr_inr_rinr"]

rate_data = mb.FetchSeries(rat_tickers)

new_column_names = {"al_fr_inr_rinr" : "rate_al",
                    "dz_fr_inr_rinr" : "rate_dz",
                    "ao_fr_inr_rinr" : "rate_ao",
                    "ar_fr_inr_rinr" : "rate_ar",
                    "am_fr_inr_rinr" : "rate_am",
                    "at_fr_inr_rinr" : "rate_at",
                    "az_fr_inr_rinr" : "rate_az",
                    "bd_fr_inr_rinr" : "rate_bd",
                    "by_fr_inr_rinr" : "rate_by",
                    "be_fr_inr_rinr" : "rate_be",
                    "bj_fr_inr_rinr" : "rate_bj",
                    "bo_fr_inr_rinr" : "rate_bo",
                    "ba_fr_inr_rinr" : "rate_ba",
                    "bw_fr_inr_rinr" : "rate_bw",
                    "br_fr_inr_rinr" : "rate_br",
                    "bg_fr_inr_rinr" : "rate_bg",
                    "bf_fr_inr_rinr" : "rate_bf",
                    "bi_fr_inr_rinr" : "rate_bi",
                    "kh_fr_inr_rinr" : "rate_kh",
                    "cm_fr_inr_rinr" : "rate_cm",
                    "cv_fr_inr_rinr" : "rate_cv",
                    "cf_fr_inr_rinr" : "rate_cf",
                    "td_fr_inr_rinr" : "rate_td",
                    "cl_fr_inr_rinr" : "rate_cl",
                    "cn_fr_inr_rinr" : "rate_cn",
                    "co_fr_inr_rinr" : "rate_co",
                    "km_fr_inr_rinr" : "rate_km",
                    "cd_fr_inr_rinr" : "rate_cd",
                    "cg_fr_inr_rinr" : "rate_cg",
                    "cr_fr_inr_rinr" : "rate_cr",
                    "ci_fr_inr_rinr" : "rate_ci",
                    "hr_fr_inr_rinr" : "rate_hr",
                    "cz_fr_inr_rinr" : "rate_cz",
                    "dk_fr_inr_rinr" : "rate_dk",
                    "dj_fr_inr_rinr" : "rate_dj",
                    "dm_fr_inr_rinr" : "rate_dm",
                    "do_fr_inr_rinr" : "rate_do",
                    "ec_fr_inr_rinr" : "rate_ec",
                    "eg_fr_inr_rinr" : "rate_eg",
                    "sv_fr_inr_rinr" : "rate_sv",
                    "gq_fr_inr_rinr" : "rate_gq",
                    "er_fr_inr_rinr" : "rate_er",
                    "ee_fr_inr_rinr" : "rate_ee",
                    "et_fr_inr_rinr" : "rate_et",
                    "fj_fr_inr_rinr" : "rate_fj",
                    "fi_fr_inr_rinr" : "rate_fi",
                    "fr_fr_inr_rinr" : "rate_fr",
                    "ga_fr_inr_rinr" : "rate_ga",
                    "gm_fr_inr_rinr" : "rate_gm",
                    "ge_fr_inr_rinr" : "rate_ge",
                    "de_fr_inr_rinr" : "rate_de",
                    "gh_fr_inr_rinr" : "rate_gh",
                    "gr_fr_inr_rinr" : "rate_gr",
                    "gd_fr_inr_rinr" : "rate_gd",
                    "gt_fr_inr_rinr" : "rate_gt",
                    "gn_fr_inr_rinr" : "rate_gn",
                    "gw_fr_inr_rinr" : "rate_gw",
                    "gy_fr_inr_rinr" : "rate_gy",
                    "ht_fr_inr_rinr" : "rate_ht",
                    "hn_fr_inr_rinr" : "rate_hn",
                    "hu_fr_inr_rinr" : "rate_hu",
                    "is_fr_inr_rinr" : "rate_is",
                    "in_fr_inr_rinr" : "rate_in",
                    "id_fr_inr_rinr" : "rate_id",
                    "ir_fr_inr_rinr" : "rate_ir",
                    "ie_fr_inr_rinr" : "rate_ie",
                    "il_fr_inr_rinr" : "rate_il",
                    "it_fr_inr_rinr" : "rate_it",
                    "jm_fr_inr_rinr" : "rate_jm",
                    "jp_fr_inr_rinr" : "rate_jp",
                    "jo_fr_inr_rinr" : "rate_jo",
                    "kz_fr_inr_rinr" : "rate_kz",
                    "ke_fr_inr_rinr" : "rate_ke",
                    "kr_fr_inr_rinr" : "rate_kr",
                    "kw_fr_inr_rinr" : "rate_kw",
                    "kg_fr_inr_rinr" : "rate_kg",
                    "la_fr_inr_rinr" : "rate_la",
                    "lv_fr_inr_rinr" : "rate_lv",
                    "lb_fr_inr_rinr" : "rate_lb",
                    "ls_fr_inr_rinr" : "rate_ls",
                    "lr_fr_inr_rinr" : "rate_lr",
                    "ly_fr_inr_rinr" : "rate_ly",
                    "lt_fr_inr_rinr" : "rate_lt",
                    "lu_fr_inr_rinr" : "rate_lu",
                    "mk_fr_inr_rinr" : "rate_mk",
                    "mg_fr_inr_rinr" : "rate_mg",
                    "mw_fr_inr_rinr" : "rate_mw",
                    "my_fr_inr_rinr" : "rate_my",
                    "mv_fr_inr_rinr" : "rate_mv",
                    "ml_fr_inr_rinr" : "rate_ml",
                    "mr_fr_inr_rinr" : "rate_mr",
                    "mx_fr_inr_rinr" : "rate_mx",
                    "md_fr_inr_rinr" : "rate_md",
                    "mn_fr_inr_rinr" : "rate_mn",
                    "ma_fr_inr_rinr" : "rate_ma",
                    "mz_fr_inr_rinr" : "rate_mz",
                    "mm_fr_inr_rinr" : "rate_mm",
                    "na_fr_inr_rinr" : "rate_na",
                    "np_fr_inr_rinr" : "rate_np",
                    "nl_fr_inr_rinr" : "rate_nl",
                    "nz_fr_inr_rinr" : "rate_nz",
                    "ni_fr_inr_rinr" : "rate_ni",
                    "ne_fr_inr_rinr" : "rate_ne",
                    "ng_fr_inr_rinr" : "rate_ng",
                    "no_fr_inr_rinr" : "rate_no",
                    "pk_fr_inr_rinr" : "rate_pk",
                    "pa_fr_inr_rinr" : "rate_pa",
                    "pg_fr_inr_rinr" : "rate_pg",
                    "py_fr_inr_rinr" : "rate_py",
                    "pe_fr_inr_rinr" : "rate_pe",
                    "ph_fr_inr_rinr" : "rate_ph",
                    "pl_fr_inr_rinr" : "rate_pl",
                    "pt_fr_inr_rinr" : "rate_pt",
                    "ro_fr_inr_rinr" : "rate_ro",
                    "ru_fr_inr_rinr" : "rate_ru",
                    "rw_fr_inr_rinr" : "rate_rw",
                    "st_fr_inr_rinr" : "rate_st",
                    "sn_fr_inr_rinr" : "rate_sn",
                    "rs_fr_inr_rinr" : "rate_rs",
                    "sc_fr_inr_rinr" : "rate_sc",
                    "sl_fr_inr_rinr" : "rate_sl",
                    "sk_fr_inr_rinr" : "rate_sk",
                    "si_fr_inr_rinr" : "rate_si",
                    "za_fr_inr_rinr" : "rate_za",
                    "es_fr_inr_rinr" : "rate_es",
                    "lk_fr_inr_rinr" : "rate_lk",
                    "sd_fr_inr_rinr" : "rate_sd",
                    "sr_fr_inr_rinr" : "rate_sr",
                    "se_fr_inr_rinr" : "rate_se",
                    "sy_fr_inr_rinr" : "rate_sy",
                    "ch_fr_inr_rinr" : "rate_ch",
                    "tj_fr_inr_rinr" : "rate_tj",
                    "tz_fr_inr_rinr" : "rate_tz",
                    "th_fr_inr_rinr" : "rate_th",
                    "tg_fr_inr_rinr" : "rate_tg",
                    "tt_fr_inr_rinr" : "rate_tt",
                    "tn_fr_inr_rinr" : "rate_tn",
                    "tr_fr_inr_rinr" : "rate_tr",
                    "tm_fr_inr_rinr" : "rate_tm",
                    "ug_fr_inr_rinr" : "rate_ug",
                    "ua_fr_inr_rinr" : "rate_ua",
                    "gb_fr_inr_rinr" : "rate_gb",
                    "us_fr_inr_rinr" : "rate_us",
                    "uy_fr_inr_rinr" : "rate_uy",
                    "uz_fr_inr_rinr" : "rate_uz",
                    "ve_fr_inr_rinr" : "rate_ve",
                    "vn_fr_inr_rinr" : "rate_vn",
                    "ye_fr_inr_rinr" : "rate_ye",
                    "zm_fr_inr_rinr" : "rate_zm",
                    "zw_fr_inr_rinr" : "rate_zw"}

rate_data = rate_data.rename(columns = new_column_names)
print(rate_data.head())


# Now we move to the activity section (this is a generalised pca of a basket of metrics - kept in-house)

yield_tickers = ["ALJPBYGDAR Index",
                "DZJPBYGDAR Index",
                "AOJPBYGDAR Index",
                "ARJPBYGDAR Index",
                "AMJPBYGDAR Index",
                "ATJPBYGDAR Index",
                "AZJPBYGDAR Index",
                "BDJPBYGDAR Index",
                "BYJPBYGDAR Index",
                "BEJPBYGDAR Index",
                "BJJPBYGDAR Index",
                "BOJPBYGDAR Index",
                "BAJPBYGDAR Index",
                "BWJPBYGDAR Index",
                "BRJPBYGDAR Index",
                "BGJPBYGDAR Index",
                "BFJPBYGDAR Index",
                "BIJPBYGDAR Index",
                "KHJPBYGDAR Index",
                "CMJPBYGDAR Index",
                "CVJPBYGDAR Index",
                "CFJPBYGDAR Index",
                "TDJPBYGDAR Index",
                "CLJPBYGDAR Index",
                "CNJPBYGDAR Index",
                "COJPBYGDAR Index",
                "KMJPBYGDAR Index",
                "CDJPBYGDAR Index",
                "CGJPBYGDAR Index",
                "CRJPBYGDAR Index",
                "CIJPBYGDAR Index",
                "HRJPBYGDAR Index",
                "CZJPBYGDAR Index",
                "DKJPBYGDAR Index",
                "DJJPBYGDAR Index",
                "DMJPBYGDAR Index",
                "DOJPBYGDAR Index",
                "ECJPBYGDAR Index",
                "EGJPBYGDAR Index",
                "SVJPBYGDAR Index",
                "GQJPBYGDAR Index",
                "ERJPBYGDAR Index",
                "EEJPBYGDAR Index",
                "ETJPBYGDAR Index",
                "FJJPBYGDAR Index",
                "FIJPBYGDAR Index",
                "FRJPBYGDAR Index",
                "GAJPBYGDAR Index",
                "GMJPBYGDAR Index",
                "GEJPBYGDAR Index",
                "DEJPBYGDAR Index",
                "GHJPBYGDAR Index",
                "GRJPBYGDAR Index",
                "GDJPBYGDAR Index",
                "GTJPBYGDAR Index",
                "GNJPBYGDAR Index",
                "GWJPBYGDAR Index",
                "GYJPBYGDAR Index",
                "HTJPBYGDAR Index",
                "HNJPBYGDAR Index",
                "HUJPBYGDAR Index",
                "ISJPBYGDAR Index",
                "INJPBYGDAR Index",
                "IDJPBYGDAR Index",
                "IRJPBYGDAR Index",
                "IEJPBYGDAR Index",
                "ILJPBYGDAR Index",
                "ITJPBYGDAR Index",
                "JMJPBYGDAR Index",
                "JPJPBYGDAR Index",
                "JOJPBYGDAR Index",
                "KZJPBYGDAR Index",
                "KEJPBYGDAR Index",
                "KRJPBYGDAR Index",
                "KWJPBYGDAR Index",
                "KGJPBYGDAR Index",
                "LAJPBYGDAR Index",
                "LVJPBYGDAR Index",
                "LBJPBYGDAR Index",
                "LSJPBYGDAR Index",
                "LRJPBYGDAR Index",
                "LYJPBYGDAR Index",
                "LTJPBYGDAR Index",
                "LUJPBYGDAR Index",
                "MKJPBYGDAR Index",
                "MGJPBYGDAR Index",
                "MWJPBYGDAR Index",
                "MYJPBYGDAR Index",
                "MVJPBYGDAR Index",
                "MLJPBYGDAR Index",
                "MRJPBYGDAR Index",
                "MXJPBYGDAR Index",
                "MDJPBYGDAR Index",
                "MNJPBYGDAR Index",
                "MAJPBYGDAR Index",
                "MZJPBYGDAR Index",
                "MMJPBYGDAR Index",
                "NAJPBYGDAR Index",
                "NPJPBYGDAR Index",
                "NLJPBYGDAR Index",
                "NZJPBYGDAR Index",
                "NIJPBYGDAR Index",
                "NEJPBYGDAR Index",
                "NGJPBYGDAR Index",
                "NOJPBYGDAR Index",
                "PKJPBYGDAR Index",
                "PAJPBYGDAR Index",
                "PGJPBYGDAR Index",
                "PYJPBYGDAR Index",
                "PEJPBYGDAR Index",
                "PHJPBYGDAR Index",
                "PLJPBYGDAR Index",
                "PTJPBYGDAR Index",
                "ROJPBYGDAR Index",
                "RUJPBYGDAR Index",
                "RWJPBYGDAR Index",
                "STJPBYGDAR Index",
                "SNJPBYGDAR Index",
                "RSJPBYGDAR Index",
                "SCJPBYGDAR Index",
                "SLJPBYGDAR Index",
                "SKJPBYGDAR Index",
                "SIJPBYGDAR Index",
                "ZAJPBYGDAR Index",
                "ESJPBYGDAR Index",
                "LKJPBYGDAR Index",
                "SDJPBYGDAR Index",
                "SRJPBYGDAR Index",
                "SEJPBYGDAR Index",
                "SYJPBYGDAR Index",
                "CHJPBYGDAR Index",
                "TJJPBYGDAR Index",
                "TZJPBYGDAR Index",
                "THJPBYGDAR Index",
                "TGJPBYGDAR Index",
                "TTJPBYGDAR Index",
                "TNJPBYGDAR Index",
                "TRJPBYGDAR Index",
                "TMJPBYGDAR Index",
                "UGJPBYGDAR Index",
                "UAJPBYGDAR Index",
                "GBJPBYGDAR Index",
                "USJPBYGDAR Index",
                "UYJPBYGDAR Index",
                "UZJPBYGDAR Index",
                "VEJPBYGDAR Index",
                "VNJPBYGDAR Index",
                "YEJPBYGDAR Index",
                "ZMJPBYGDAR Index",
                "ZWJPBYGDAR Index" ]
                
dt_from = dt.date(1950,1,1)
dt_to = dt.date.today()

yield_data = get_bloomberg_date(yield_tickers,dt_from,dt_to,periodicity = 'DAILY')

yield_data = yield_data.rename(columns={"ALJPBYGDAR Index" : "rate_al",
                                        "DZJPBYGDAR Index" : "rate_dz",
                                        "AOJPBYGDAR Index" : "rate_ao",
                                        "ARJPBYGDAR Index" : "rate_ar",
                                        "AMJPBYGDAR Index" : "rate_am",
                                        "ATJPBYGDAR Index" : "rate_at",
                                        "AZJPBYGDAR Index" : "rate_az",
                                        "BDJPBYGDAR Index" : "rate_bd",
                                        "BYJPBYGDAR Index" : "rate_by",
                                        "BEJPBYGDAR Index" : "rate_be",
                                        "BJJPBYGDAR Index" : "rate_bj",
                                        "BOJPBYGDAR Index" : "rate_bo",
                                        "BAJPBYGDAR Index" : "rate_ba",
                                        "BWJPBYGDAR Index" : "rate_bw",
                                        "BRJPBYGDAR Index" : "rate_br",
                                        "BGJPBYGDAR Index" : "rate_bg",
                                        "BFJPBYGDAR Index" : "rate_bf",
                                        "BIJPBYGDAR Index" : "rate_bi",
                                        "KHJPBYGDAR Index" : "rate_kh",
                                        "CMJPBYGDAR Index" : "rate_cm",
                                        "CVJPBYGDAR Index" : "rate_cv",
                                        "CFJPBYGDAR Index" : "rate_cf",
                                        "TDJPBYGDAR Index" : "rate_td",
                                        "CLJPBYGDAR Index" : "rate_cl",
                                        "CNJPBYGDAR Index" : "rate_cn",
                                        "COJPBYGDAR Index" : "rate_co",
                                        "KMJPBYGDAR Index" : "rate_km",
                                        "CDJPBYGDAR Index" : "rate_cd",
                                        "CGJPBYGDAR Index" : "rate_cg",
                                        "CRJPBYGDAR Index" : "rate_cr",
                                        "CIJPBYGDAR Index" : "rate_ci",
                                        "HRJPBYGDAR Index" : "rate_hr",
                                        "CZJPBYGDAR Index" : "rate_cz",
                                        "DKJPBYGDAR Index" : "rate_dk",
                                        "DJJPBYGDAR Index" : "rate_dj",
                                        "DMJPBYGDAR Index" : "rate_dm",
                                        "DOJPBYGDAR Index" : "rate_do",
                                        "ECJPBYGDAR Index" : "rate_ec",
                                        "EGJPBYGDAR Index" : "rate_eg",
                                        "SVJPBYGDAR Index" : "rate_sv",
                                        "GQJPBYGDAR Index" : "rate_gq",
                                        "ERJPBYGDAR Index" : "rate_er",
                                        "EEJPBYGDAR Index" : "rate_ee",
                                        "ETJPBYGDAR Index" : "rate_et",
                                        "FJJPBYGDAR Index" : "rate_fj",
                                        "FIJPBYGDAR Index" : "rate_fi",
                                        "FRJPBYGDAR Index" : "rate_fr",
                                        "GAJPBYGDAR Index" : "rate_ga",
                                        "GMJPBYGDAR Index" : "rate_gm",
                                        "GEJPBYGDAR Index" : "rate_ge",
                                        "DEJPBYGDAR Index" : "rate_de",
                                        "GHJPBYGDAR Index" : "rate_gh",
                                        "GRJPBYGDAR Index" : "rate_gr",
                                        "GDJPBYGDAR Index" : "rate_gd",
                                        "GTJPBYGDAR Index" : "rate_gt",
                                        "GNJPBYGDAR Index" : "rate_gn",
                                        "GWJPBYGDAR Index" : "rate_gw",
                                        "GYJPBYGDAR Index" : "rate_gy",
                                        "HTJPBYGDAR Index" : "rate_ht",
                                        "HNJPBYGDAR Index" : "rate_hn",
                                        "HUJPBYGDAR Index" : "rate_hu",
                                        "ISJPBYGDAR Index" : "rate_is",
                                        "INJPBYGDAR Index" : "rate_in",
                                        "IDJPBYGDAR Index" : "rate_id",
                                        "IRJPBYGDAR Index" : "rate_ir",
                                        "IEJPBYGDAR Index" : "rate_ie",
                                        "ILJPBYGDAR Index" : "rate_il",
                                        "ITJPBYGDAR Index" : "rate_it",
                                        "JMJPBYGDAR Index" : "rate_jm",
                                        "JPJPBYGDAR Index" : "rate_jp",
                                        "JOJPBYGDAR Index" : "rate_jo",
                                        "KZJPBYGDAR Index" : "rate_kz",
                                        "KEJPBYGDAR Index" : "rate_ke",
                                        "KRJPBYGDAR Index" : "rate_kr",
                                        "KWJPBYGDAR Index" : "rate_kw",
                                        "KGJPBYGDAR Index" : "rate_kg",
                                        "LAJPBYGDAR Index" : "rate_la",
                                        "LVJPBYGDAR Index" : "rate_lv",
                                        "LBJPBYGDAR Index" : "rate_lb",
                                        "LSJPBYGDAR Index" : "rate_ls",
                                        "LRJPBYGDAR Index" : "rate_lr",
                                        "LYJPBYGDAR Index" : "rate_ly",
                                        "LTJPBYGDAR Index" : "rate_lt",
                                        "LUJPBYGDAR Index" : "rate_lu",
                                        "MKJPBYGDAR Index" : "rate_mk",
                                        "MGJPBYGDAR Index" : "rate_mg",
                                        "MWJPBYGDAR Index" : "rate_mw",
                                        "MYJPBYGDAR Index" : "rate_my",
                                        "MVJPBYGDAR Index" : "rate_mv",
                                        "MLJPBYGDAR Index" : "rate_ml",
                                        "MRJPBYGDAR Index" : "rate_mr",
                                        "MXJPBYGDAR Index" : "rate_mx",
                                        "MDJPBYGDAR Index" : "rate_md",
                                        "MNJPBYGDAR Index" : "rate_mn",
                                        "MAJPBYGDAR Index" : "rate_ma",
                                        "MZJPBYGDAR Index" : "rate_mz",
                                        "MMJPBYGDAR Index" : "rate_mm",
                                        "NAJPBYGDAR Index" : "rate_na",
                                        "NPJPBYGDAR Index" : "rate_np",
                                        "NLJPBYGDAR Index" : "rate_nl",
                                        "NZJPBYGDAR Index" : "rate_nz",
                                        "NIJPBYGDAR Index" : "rate_ni",
                                        "NEJPBYGDAR Index" : "rate_ne",
                                        "NGJPBYGDAR Index" : "rate_ng",
                                        "NOJPBYGDAR Index" : "rate_no",
                                        "PKJPBYGDAR Index" : "rate_pk",
                                        "PAJPBYGDAR Index" : "rate_pa",
                                        "PGJPBYGDAR Index" : "rate_pg",
                                        "PYJPBYGDAR Index" : "rate_py",
                                        "PEJPBYGDAR Index" : "rate_pe",
                                        "PHJPBYGDAR Index" : "rate_ph",
                                        "PLJPBYGDAR Index" : "rate_pl",
                                        "PTJPBYGDAR Index" : "rate_pt",
                                        "ROJPBYGDAR Index" : "rate_ro",
                                        "RUJPBYGDAR Index" : "rate_ru",
                                        "RWJPBYGDAR Index" : "rate_rw",
                                        "STJPBYGDAR Index" : "rate_st",
                                        "SNJPBYGDAR Index" : "rate_sn",
                                        "RSJPBYGDAR Index" : "rate_rs",
                                        "SCJPBYGDAR Index" : "rate_sc",
                                        "SLJPBYGDAR Index" : "rate_sl",
                                        "SKJPBYGDAR Index" : "rate_sk",
                                        "SIJPBYGDAR Index" : "rate_si",
                                        "ZAJPBYGDAR Index" : "rate_za",
                                        "ESJPBYGDAR Index" : "rate_es",
                                        "LKJPBYGDAR Index" : "rate_lk",
                                        "SDJPBYGDAR Index" : "rate_sd",
                                        "SRJPBYGDAR Index" : "rate_sr",
                                        "SEJPBYGDAR Index" : "rate_se",
                                        "SYJPBYGDAR Index" : "rate_sy",
                                        "CHJPBYGDAR Index" : "rate_ch",
                                        "TJJPBYGDAR Index" : "rate_tj",
                                        "TZJPBYGDAR Index" : "rate_tz",
                                        "THJPBYGDAR Index" : "rate_th",
                                        "TGJPBYGDAR Index" : "rate_tg",
                                        "TTJPBYGDAR Index" : "rate_tt",
                                        "TNJPBYGDAR Index" : "rate_tn",
                                        "TRJPBYGDAR Index" : "rate_tr",
                                        "TMJPBYGDAR Index" : "rate_tm",
                                        "UGJPBYGDAR Index" : "rate_ug",
                                        "UAJPBYGDAR Index" : "rate_ua",
                                        "GBJPBYGDAR Index" : "rate_gb",
                                        "USJPBYGDAR Index" : "rate_us",
                                        "UYJPBYGDAR Index" : "rate_uy",
                                        "UZJPBYGDAR Index" : "rate_uz",
                                        "VEJPBYGDAR Index" : "rate_ve",
                                        "VNJPBYGDAR Index" : "rate_vn",
                                        "YEJPBYGDAR Index" : "rate_ye",
                                        "ZMJPBYGDAR Index" : "rate_zm",
                                        "ZWJPBYGDAR Index" : "rate_zw"           })

print(yield_data.head())

# Now we move to external reserves as a share of short term debt (Macrobond)

inf_tickers = ["imfweo_al_pcpie",
                "imfweo_dz_pcpie",
                "imfweo_ao_pcpie",
                "imfweo_ar_pcpie",
                "imfweo_am_pcpie",
                "imfweo_at_pcpie",
                "imfweo_az_pcpie",
                "imfweo_bd_pcpie",
                "imfweo_by_pcpie",
                "imfweo_be_pcpie",
                "imfweo_bj_pcpie",
                "imfweo_bo_pcpie",
                "imfweo_ba_pcpie",
                "imfweo_bw_pcpie",
                "imfweo_br_pcpie",
                "imfweo_bg_pcpie",
                "imfweo_bf_pcpie",
                "imfweo_bi_pcpie",
                "imfweo_kh_pcpie",
                "imfweo_cm_pcpie",
                "imfweo_cv_pcpie",
                "imfweo_cf_pcpie",
                "imfweo_td_pcpie",
                "imfweo_cl_pcpie",
                "imfweo_cn_pcpie",
                "imfweo_co_pcpie",
                "imfweo_km_pcpie",
                "imfweo_cd_pcpie",
                "imfweo_cg_pcpie",
                "imfweo_cr_pcpie",
                "imfweo_ci_pcpie",
                "imfweo_hr_pcpie",
                "imfweo_cz_pcpie",
                "imfweo_dk_pcpie",
                "imfweo_dj_pcpie",
                "imfweo_dm_pcpie",
                "imfweo_do_pcpie",
                "imfweo_ec_pcpie",
                "imfweo_eg_pcpie",
                "imfweo_sv_pcpie",
                "imfweo_gq_pcpie",
                "imfweo_er_pcpie",
                "imfweo_ee_pcpie",
                "imfweo_et_pcpie",
                "imfweo_fj_pcpie",
                "imfweo_fi_pcpie",
                "imfweo_fr_pcpie",
                "imfweo_ga_pcpie",
                "imfweo_gm_pcpie",
                "imfweo_ge_pcpie",
                "imfweo_de_pcpie",
                "imfweo_gh_pcpie",
                "imfweo_gr_pcpie",
                "imfweo_gd_pcpie",
                "imfweo_gt_pcpie",
                "imfweo_gn_pcpie",
                "imfweo_gw_pcpie",
                "imfweo_gy_pcpie",
                "imfweo_ht_pcpie",
                "imfweo_hn_pcpie",
                "imfweo_hu_pcpie",
                "imfweo_is_pcpie",
                "imfweo_in_pcpie",
                "imfweo_id_pcpie",
                "imfweo_ir_pcpie",
                "imfweo_ie_pcpie",
                "imfweo_il_pcpie",
                "imfweo_it_pcpie",
                "imfweo_jm_pcpie",
                "imfweo_jp_pcpie",
                "imfweo_jo_pcpie",
                "imfweo_kz_pcpie",
                "imfweo_ke_pcpie",
                "imfweo_kr_pcpie",
                "imfweo_kw_pcpie",
                "imfweo_kg_pcpie",
                "imfweo_la_pcpie",
                "imfweo_lv_pcpie",
                "imfweo_lb_pcpie",
                "imfweo_ls_pcpie",
                "imfweo_lr_pcpie",
                "imfweo_ly_pcpie",
                "imfweo_lt_pcpie",
                "imfweo_lu_pcpie",
                "imfweo_mk_pcpie",
                "imfweo_mg_pcpie",
                "imfweo_mw_pcpie",
                "imfweo_my_pcpie",
                "imfweo_mv_pcpie",
                "imfweo_ml_pcpie",
                "imfweo_mr_pcpie",
                "imfweo_mx_pcpie",
                "imfweo_md_pcpie",
                "imfweo_mn_pcpie",
                "imfweo_ma_pcpie",
                "imfweo_mz_pcpie",
                "imfweo_mm_pcpie",
                "imfweo_na_pcpie",
                "imfweo_np_pcpie",
                "imfweo_nl_pcpie",
                "imfweo_nz_pcpie",
                "imfweo_ni_pcpie",
                "imfweo_ne_pcpie",
                "imfweo_ng_pcpie",
                "imfweo_no_pcpie",
                "imfweo_pk_pcpie",
                "imfweo_pa_pcpie",
                "imfweo_pg_pcpie",
                "imfweo_py_pcpie",
                "imfweo_pe_pcpie",
                "imfweo_ph_pcpie",
                "imfweo_pl_pcpie",
                "imfweo_pt_pcpie",
                "imfweo_ro_pcpie",
                "imfweo_ru_pcpie",
                "imfweo_rw_pcpie",
                "imfweo_st_pcpie",
                "imfweo_sn_pcpie",
                "imfweo_rs_pcpie",
                "imfweo_sc_pcpie",
                "imfweo_sl_pcpie",
                "imfweo_sk_pcpie",
                "imfweo_si_pcpie",
                "imfweo_za_pcpie",
                "imfweo_es_pcpie",
                "imfweo_lk_pcpie",
                "imfweo_sd_pcpie",
                "imfweo_sr_pcpie",
                "imfweo_se_pcpie",
                "imfweo_sy_pcpie",
                "imfweo_ch_pcpie",
                "imfweo_tj_pcpie",
                "imfweo_tz_pcpie",
                "imfweo_th_pcpie",
                "imfweo_tg_pcpie",
                "imfweo_tt_pcpie",
                "imfweo_tn_pcpie",
                "imfweo_tr_pcpie",
                "imfweo_tm_pcpie",
                "imfweo_ug_pcpie",
                "imfweo_ua_pcpie",
                "imfweo_gb_pcpie",
                "imfweo_us_pcpie",
                "imfweo_uy_pcpie",
                "imfweo_uz_pcpie",
                "imfweo_ve_pcpie",
                "imfweo_vn_pcpie",
                "imfweo_ye_pcpie",
                "imfweo_zm_pcpie",
                "imfweo_zw_pcpie"
                                    ]

inf_data = mb.FetchSeries(inf_tickers)

new_column_names = {"imfweo_al_pcpie" : "inf_al",
                    "imfweo_dz_pcpie" : "inf_dz",
                    "imfweo_ao_pcpie" : "inf_ao",
                    "imfweo_ar_pcpie" : "inf_ar",
                    "imfweo_am_pcpie" : "inf_am",
                    "imfweo_at_pcpie" : "inf_at",
                    "imfweo_az_pcpie" : "inf_az",
                    "imfweo_bd_pcpie" : "inf_bd",
                    "imfweo_by_pcpie" : "inf_by",
                    "imfweo_be_pcpie" : "inf_be",
                    "imfweo_bj_pcpie" : "inf_bj",
                    "imfweo_bo_pcpie" : "inf_bo",
                    "imfweo_ba_pcpie" : "inf_ba",
                    "imfweo_bw_pcpie" : "inf_bw",
                    "imfweo_br_pcpie" : "inf_br",
                    "imfweo_bg_pcpie" : "inf_bg",
                    "imfweo_bf_pcpie" : "inf_bf",
                    "imfweo_bi_pcpie" : "inf_bi",
                    "imfweo_kh_pcpie" : "inf_kh",
                    "imfweo_cm_pcpie" : "inf_cm",
                    "imfweo_cv_pcpie" : "inf_cv",
                    "imfweo_cf_pcpie" : "inf_cf",
                    "imfweo_td_pcpie" : "inf_td",
                    "imfweo_cl_pcpie" : "inf_cl",
                    "imfweo_cn_pcpie" : "inf_cn",
                    "imfweo_co_pcpie" : "inf_co",
                    "imfweo_km_pcpie" : "inf_km",
                    "imfweo_cd_pcpie" : "inf_cd",
                    "imfweo_cg_pcpie" : "inf_cg",
                    "imfweo_cr_pcpie" : "inf_cr",
                    "imfweo_ci_pcpie" : "inf_ci",
                    "imfweo_hr_pcpie" : "inf_hr",
                    "imfweo_cz_pcpie" : "inf_cz",
                    "imfweo_dk_pcpie" : "inf_dk",
                    "imfweo_dj_pcpie" : "inf_dj",
                    "imfweo_dm_pcpie" : "inf_dm",
                    "imfweo_do_pcpie" : "inf_do",
                    "imfweo_ec_pcpie" : "inf_ec",
                    "imfweo_eg_pcpie" : "inf_eg",
                    "imfweo_sv_pcpie" : "inf_sv",
                    "imfweo_gq_pcpie" : "inf_gq",
                    "imfweo_er_pcpie" : "inf_er",
                    "imfweo_ee_pcpie" : "inf_ee",
                    "imfweo_et_pcpie" : "inf_et",
                    "imfweo_fj_pcpie" : "inf_fj",
                    "imfweo_fi_pcpie" : "inf_fi",
                    "imfweo_fr_pcpie" : "inf_fr",
                    "imfweo_ga_pcpie" : "inf_ga",
                    "imfweo_gm_pcpie" : "inf_gm",
                    "imfweo_ge_pcpie" : "inf_ge",
                    "imfweo_de_pcpie" : "inf_de",
                    "imfweo_gh_pcpie" : "inf_gh",
                    "imfweo_gr_pcpie" : "inf_gr",
                    "imfweo_gd_pcpie" : "inf_gd",
                    "imfweo_gt_pcpie" : "inf_gt",
                    "imfweo_gn_pcpie" : "inf_gn",
                    "imfweo_gw_pcpie" : "inf_gw",
                    "imfweo_gy_pcpie" : "inf_gy",
                    "imfweo_ht_pcpie" : "inf_ht",
                    "imfweo_hn_pcpie" : "inf_hn",
                    "imfweo_hu_pcpie" : "inf_hu",
                    "imfweo_is_pcpie" : "inf_is",
                    "imfweo_in_pcpie" : "inf_in",
                    "imfweo_id_pcpie" : "inf_id",
                    "imfweo_ir_pcpie" : "inf_ir",
                    "imfweo_ie_pcpie" : "inf_ie",
                    "imfweo_il_pcpie" : "inf_il",
                    "imfweo_it_pcpie" : "inf_it",
                    "imfweo_jm_pcpie" : "inf_jm",
                    "imfweo_jp_pcpie" : "inf_jp",
                    "imfweo_jo_pcpie" : "inf_jo",
                    "imfweo_kz_pcpie" : "inf_kz",
                    "imfweo_ke_pcpie" : "inf_ke",
                    "imfweo_kr_pcpie" : "inf_kr",
                    "imfweo_kw_pcpie" : "inf_kw",
                    "imfweo_kg_pcpie" : "inf_kg",
                    "imfweo_la_pcpie" : "inf_la",
                    "imfweo_lv_pcpie" : "inf_lv",
                    "imfweo_lb_pcpie" : "inf_lb",
                    "imfweo_ls_pcpie" : "inf_ls",
                    "imfweo_lr_pcpie" : "inf_lr",
                    "imfweo_ly_pcpie" : "inf_ly",
                    "imfweo_lt_pcpie" : "inf_lt",
                    "imfweo_lu_pcpie" : "inf_lu",
                    "imfweo_mk_pcpie" : "inf_mk",
                    "imfweo_mg_pcpie" : "inf_mg",
                    "imfweo_mw_pcpie" : "inf_mw",
                    "imfweo_my_pcpie" : "inf_my",
                    "imfweo_mv_pcpie" : "inf_mv",
                    "imfweo_ml_pcpie" : "inf_ml",
                    "imfweo_mr_pcpie" : "inf_mr",
                    "imfweo_mx_pcpie" : "inf_mx",
                    "imfweo_md_pcpie" : "inf_md",
                    "imfweo_mn_pcpie" : "inf_mn",
                    "imfweo_ma_pcpie" : "inf_ma",
                    "imfweo_mz_pcpie" : "inf_mz",
                    "imfweo_mm_pcpie" : "inf_mm",
                    "imfweo_na_pcpie" : "inf_na",
                    "imfweo_np_pcpie" : "inf_np",
                    "imfweo_nl_pcpie" : "inf_nl",
                    "imfweo_nz_pcpie" : "inf_nz",
                    "imfweo_ni_pcpie" : "inf_ni",
                    "imfweo_ne_pcpie" : "inf_ne",
                    "imfweo_ng_pcpie" : "inf_ng",
                    "imfweo_no_pcpie" : "inf_no",
                    "imfweo_pk_pcpie" : "inf_pk",
                    "imfweo_pa_pcpie" : "inf_pa",
                    "imfweo_pg_pcpie" : "inf_pg",
                    "imfweo_py_pcpie" : "inf_py",
                    "imfweo_pe_pcpie" : "inf_pe",
                    "imfweo_ph_pcpie" : "inf_ph",
                    "imfweo_pl_pcpie" : "inf_pl",
                    "imfweo_pt_pcpie" : "inf_pt",
                    "imfweo_ro_pcpie" : "inf_ro",
                    "imfweo_ru_pcpie" : "inf_ru",
                    "imfweo_rw_pcpie" : "inf_rw",
                    "imfweo_st_pcpie" : "inf_st",
                    "imfweo_sn_pcpie" : "inf_sn",
                    "imfweo_rs_pcpie" : "inf_rs",
                    "imfweo_sc_pcpie" : "inf_sc",
                    "imfweo_sl_pcpie" : "inf_sl",
                    "imfweo_sk_pcpie" : "inf_sk",
                    "imfweo_si_pcpie" : "inf_si",
                    "imfweo_za_pcpie" : "inf_za",
                    "imfweo_es_pcpie" : "inf_es",
                    "imfweo_lk_pcpie" : "inf_lk",
                    "imfweo_sd_pcpie" : "inf_sd",
                    "imfweo_sr_pcpie" : "inf_sr",
                    "imfweo_se_pcpie" : "inf_se",
                    "imfweo_sy_pcpie" : "inf_sy",
                    "imfweo_ch_pcpie" : "inf_ch",
                    "imfweo_tj_pcpie" : "inf_tj",
                    "imfweo_tz_pcpie" : "inf_tz",
                    "imfweo_th_pcpie" : "inf_th",
                    "imfweo_tg_pcpie" : "inf_tg",
                    "imfweo_tt_pcpie" : "inf_tt",
                    "imfweo_tn_pcpie" : "inf_tn",
                    "imfweo_tr_pcpie" : "inf_tr",
                    "imfweo_tm_pcpie" : "inf_tm",
                    "imfweo_ug_pcpie" : "inf_ug",
                    "imfweo_ua_pcpie" : "inf_ua",
                    "imfweo_gb_pcpie" : "inf_gb",
                    "imfweo_us_pcpie" : "inf_us",
                    "imfweo_uy_pcpie" : "inf_uy",
                    "imfweo_uz_pcpie" : "inf_uz",
                    "imfweo_ve_pcpie" : "inf_ve",
                    "imfweo_vn_pcpie" : "inf_vn",
                    "imfweo_ye_pcpie" : "inf_ye",
                    "imfweo_zm_pcpie" : "inf_zm",
                    "imfweo_zw_pcpie" : "inf_zw"}

inf_data = inf_data.rename(columns = new_column_names)
print(inf_data.head())
